from langchain.prompts import PromptTemplate

DAILY_NLU_PROMPT = """
너는 커플의 하루 대화를 읽고,  
1) 애정표현  
2) 배려/공감  
3) 적극적 행동  
4) 격려/응원  
5) 갈등/서운함/다툼/부정적 감정  
에 해당하는 문장(혹은 발화)을 각각 몇 번 발견했는지 세어줘.  

각 항목별로 실제 예시 문장(3개 이하 샘플)도 함께 추출해줘.  
그리고 마지막엔 그날 하루 전체 요약을 5~8줄로 써줘.

JSON 형태 예시:
{
  "애정표현_횟수": 2,
  "애정표현_샘플": ["오늘도 사랑해!", "보고 싶었어"],
  "배려_횟수": 1,
  "배려_샘플": ["오늘 힘들지 않았어?", "몸 조심해!"],
  "적극_횟수": 1,
  "적극_샘플": ["내가 먼저 연락할게!"],
  "격려_횟수": 1,
  "격려_샘플": ["힘내!", "잘할 수 있어!"],
  "갈등_횟수": 2,
  "갈등_샘플": ["왜 또 그런 말을 해?", "오늘 좀 서운했어"],
  "요약": "오늘은 약간의 갈등이 있었지만 서로 배려하며 마무리했다. ..."
}

[하루 대화]
{messages}
"""

DAILY_AI_NLU_PROMPT = """
너는 연애·심리 상담 AI 분석가야.

아래는 한 사용자가 하루 동안 AI(챗봇)과 나눈 비공개 상담/대화 기록이야.  
이 대화를 바탕으로 아래 항목을 각각 분석해서 JSON 형태로 답변해줘.

1) 오늘 사용자가 AI에게 표현한 대표 감정 (최대 2가지, 예: 불안/행복/분노/권태/외로움/희망 등)
2) 주로 상담한 주제/고민(최대 2가지, 예: 권태, 다툼, 화해, 자기성장, 이별 고민 등)
3) 긍정적 발화(용기, 성장, 회복 등) 횟수와 대표 문장(최대 3개)
4) 부정적/불안/갈등 관련 발화 횟수와 대표 문장(최대 3개)
5) AI와의 대화에서 드러난 중요한 변화/심리 신호/위험 요인(있다면, 2~3문장)
6) 마지막으로 오늘 하루 AI와의 상담 전체 요약을 5~8줄로 작성

아래 JSON 예시를 참고해:

{
  "대표감정": ["불안", "외로움"],
  "상담주제": ["권태", "자존감"],
  "긍정발화_횟수": 2,
  "긍정발화_샘플": ["다시 한 번 노력해볼게요.", "요즘은 내 마음을 더 솔직히 말하려고 해요."],
  "부정발화_횟수": 3,
  "부정발화_샘플": ["사실 요즘 너무 지쳤어요.", "더 이상 어떻게 해야 할지 모르겠어."],
  "중요신호": "최근 고민의 강도가 높아지고 있으며, 상대방과의 소통이 줄었다고 반복적으로 언급함.",
  "요약": "오늘은 주로 권태와 자기감정에 대해 상담했고, 힘들지만 스스로 변화하려는 의지도 보였다. ..."
}

[AI 상담 대화]
{messages}
"""

WEEKLY_REPORT_PROMPT = """
아래는 커플의 최근 1주일간 대화에서 LLM이 분석한 주간 통계 데이터야.

- 항목별로 1주일 전체 합계와 대표 발화 샘플 리스트가 포함되어 있음.
- 요약리스트에는 하루씩의 대화 요약이 순서대로 들어있음.

이 데이터를 바탕으로
1. 전체 주간 분위기를 10줄 이내로 분석,
2. 가장 인상적이었던 긍정/부정 포인트(상황, 대화, 변곡점 등) 각각 2~3개,
3. 최근 한 주에 어울릴 만한 음악/영화 한 가지(이유와 함께) 추천,

아래 JSON으로 답변해.

{{
  "주간분위기분석": "...",
  "긍정포인트": ["..."],
  "부정포인트": ["..."],
  "추천": {{ "type": "플레이리스트/영화", "제목": "...", "이유": "..." }}
}}

[주간 통계]
{weekly_stats}
"""