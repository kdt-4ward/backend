[2025-07-13 23:26:19][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:26:19][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:26:19][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00019s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00043s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00010s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00020s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00020s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 26, 19, 642852), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 26, 19, 642855), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 26, 19, 648334)}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00022s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'question_id__0': 1, 'choice_id__0': 2, 'user_id__0': '1', 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 26, 19, 133536), 'custom_input__0': None, 'question_id__1': 2, 'choice_id__1': 8, 'user_id__1': '1', 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 26, 19, 133558), 'custom_input__1': None, 'question_id__2': 3, 'choice_id__2': 13, 'user_id__2': '1', 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 26, 19, 133566), 'custom_input__2': None, 'question_id__3': 4, 'choice_id__3': 21, 'user_id__3': '1', 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 26, 19, 133573), 'custom_input__3': None, 'question_id__4': 5, 'choice_id__4': 26, 'user_id__4': '1', 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 26, 19, 133580), 'custom_input__4': None, 'question_id__5': 1, 'choice_id__5': 1, 'user_id__5': '2', 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 26, 19, 133586), 'custom_input__5': None, 'question_id__6': 2, 'choice_id__6': 9, 'user_id__6': '2', 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 26, 19, 133592), 'custom_input__6': None, 'question_id__7': 3, 'choice_id__7': 16, 'user_id__7': '2', 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 26, 19, 133598), 'custom_input__7': None, 'question_id__8': 4, 'choice_id__8': 20, 'user_id__8': '2', 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 26, 19, 133604), 'custom_input__8': None, 'question_id__9': 5, 'choice_id__9': 25, 'user_id__9': '2', 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 26, 19, 133610), 'custom_input__9': None}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__0': '1', 'emotion__0': 'ê³ ë§ˆì›€', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__1': '1', 'emotion__1': 'ê¸°ëŒ€ê°', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__2': '1', 'emotion__2': 'ë¯¸ì•ˆí•¨', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__3': '1', 'emotion__3': 'ì£„ì±…ê°', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__4': '1', 'emotion__4': 'ì‚¬ë‘', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__5': '1', 'emotion__5': 'ë‹¤ì •í•¨', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__6': '1', 'emotion__6': 'ì¹œë°€ê°', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__7': '1', 'emotion__7': 'ì–µìš¸í•¨', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__8': '1', 'emotion__8': 'ì„œìš´í•¨', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__9': '1', 'emotion__9': 'í–‰ë³µ', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__10': '1', 'emotion__10': 'ê°ì‚¬', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__11': '1', 'emotion__11': 'ì‹ ë¢°', 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.', 'date__12': datetime.datetime(2025, 7, 7, 0, 0) ... 8 parameters truncated ... 'user_id__14': '2', 'emotion__14': 'ë°”ì¨', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__15': '2', 'emotion__15': 'ì„œìš´í•¨', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__16': '2', 'emotion__16': 'ì‹¤ë§ê°', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__17': '2', 'emotion__17': 'ì´í•´', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__18': '2', 'emotion__18': 'ë‹¤ì •í•¨', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__19': '2', 'emotion__19': 'í˜¸ê°', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__20': '2', 'emotion__20': 'í¸ì•ˆí•¨', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__21': '2', 'emotion__21': 'ê¸°ëŒ€ê°', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__22': '2', 'emotion__22': 'ë¶ˆë§Œ', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__23': '2', 'emotion__23': 'ê¸°ì¨', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__24': '2', 'emotion__24': 'ê°ë™', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__25': '2', 'emotion__25': 'ì‚¬ë‘', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__26': '2', 'emotion__26': 'ì•ˆì •ê°'}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s (insertmanyvalues) 1/1 (ordered)] {'couple_id__0': '1', 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'deleted_at__0': None, 'user_id__0': '1', 'is_delivered__0': 1, 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'embed_index__0': None, 'has_image__0': 0, 'image_url__0': None, 'couple_id__1': '1', 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'deleted_at__1': None, 'user_id__1': '2', 'is_delivered__1': 1, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'embed_index__1': None, 'has_image__1': 0, 'image_url__1': None, 'couple_id__2': '1', 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'deleted_at__2': None, 'user_id__2': '1', 'is_delivered__2': 1, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'embed_index__2': None, 'has_image__2': 0, 'image_url__2': None, 'couple_id__3': '1', 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'deleted_at__3': None, 'user_id__3': '2', 'is_delivered__3': 1, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'embed_index__3': None, 'has_image__3': 0, 'image_url__3': None, 'couple_id__4': '1', 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'deleted_at__4': None, 'user_id__4': '2', 'is_delivered__4': 1, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'embed_index__4': None, 'has_image__4': 0, 'image_url__4': None, 'couple_id__5': '1', 'created_at__5': datetime.datetime(2025, 7, 2, 17, 40), 'deleted_at__5': None, 'user_id__5': '1', 'is_delivered__5': 1 ... 170 parameters truncated ... 'is_delivered__24': 1, 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'embed_index__24': None, 'has_image__24': 0, 'image_url__24': None, 'couple_id__25': '1', 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'deleted_at__25': None, 'user_id__25': '2', 'is_delivered__25': 1, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'embed_index__25': None, 'has_image__25': 0, 'image_url__25': None, 'couple_id__26': '1', 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'deleted_at__26': None, 'user_id__26': '1', 'is_delivered__26': 1, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'embed_index__26': None, 'has_image__26': 0, 'image_url__26': None, 'couple_id__27': '1', 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'deleted_at__27': None, 'user_id__27': '2', 'is_delivered__27': 1, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'embed_index__27': None, 'has_image__27': 0, 'image_url__27': None, 'couple_id__28': '1', 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'deleted_at__28': None, 'user_id__28': '1', 'is_delivered__28': 1, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'embed_index__28': None, 'has_image__28': 0, 'image_url__28': None, 'couple_id__29': '1', 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'deleted_at__29': None, 'user_id__29': '2', 'is_delivered__29': 1, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'embed_index__29': None, 'has_image__29': 0, 'image_url__29': None}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:26:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ì•ˆë…•', 'created_at': datetime.datetime(2025, 7, 13, 14, 26, 28, 204485), 'embed_index': None}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'pk_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {'user_id_1': '2'}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [generated in 0.00022s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT users.user_id AS users_user_id, users.name AS users_name, users.email AS users_email, users.created_at AS users_created_at, users.deleted_at AS users_deleted_at, users.modified_at AS users_modified_at, users.birth AS users_birth, users.gender AS users_gender 
FROM users 
WHERE users.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [cached since 0.008126s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [cached since 0.009876s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=3
[2025-07-13 23:26:28][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:26:28][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [cached since 0.716s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•ˆë…•í•˜ì„¸ìš”, ìˆ˜ì•„! ì˜¤ëŠ˜ì€ ì–´ë–¤ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆŒê¹Œìš”? ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 26, 28, 920613), 'embed_index': None}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [cached since 0.7205s ago] {'pk_1': 2}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [cached since 0.7201s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=2
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [cached since 0.7226s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [cached since 0.7238s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] [cached since 0.7241s ago] {'user_id_1': '2'}
[2025-07-13 23:26:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:11][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:28:11][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:28:11][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00010s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00033s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00020s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00024s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:28:11][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 28, 12, 9553), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 28, 12, 9556), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 28, 12, 15211)}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'custom_input__0': None, 'user_id__0': '1', 'question_id__0': 1, 'choice_id__0': 2, 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 28, 11, 492570), 'custom_input__1': None, 'user_id__1': '1', 'question_id__1': 2, 'choice_id__1': 8, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 28, 11, 492586), 'custom_input__2': None, 'user_id__2': '1', 'question_id__2': 3, 'choice_id__2': 13, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 28, 11, 492594), 'custom_input__3': None, 'user_id__3': '1', 'question_id__3': 4, 'choice_id__3': 21, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 28, 11, 492602), 'custom_input__4': None, 'user_id__4': '1', 'question_id__4': 5, 'choice_id__4': 26, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 28, 11, 492609), 'custom_input__5': None, 'user_id__5': '2', 'question_id__5': 1, 'choice_id__5': 1, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 28, 11, 492615), 'custom_input__6': None, 'user_id__6': '2', 'question_id__6': 2, 'choice_id__6': 9, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 28, 11, 492620), 'custom_input__7': None, 'user_id__7': '2', 'question_id__7': 3, 'choice_id__7': 16, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 28, 11, 492626), 'custom_input__8': None, 'user_id__8': '2', 'question_id__8': 4, 'choice_id__8': 20, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 28, 11, 492632), 'custom_input__9': None, 'user_id__9': '2', 'question_id__9': 5, 'choice_id__9': 25, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 28, 11, 492638)}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__0': 'ê³ ë§ˆì›€', 'user_id__0': '1', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'user_id__1': '1', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'user_id__2': '1', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'user_id__3': '1', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'user_id__4': '1', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'user_id__5': '1', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'user_id__6': '1', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'user_id__7': '1', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'user_id__8': '1', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__9': 'í–‰ë³µ', 'user_id__9': '1', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'user_id__10': '1', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'user_id__11': '1', 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.', 'date__12': datetime.datetime(2025, 7, 7, 0, 0) ... 8 parameters truncated ... 'emotion__14': 'ë°”ì¨', 'user_id__14': '2', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'user_id__15': '2', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'user_id__16': '2', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__17': 'ì´í•´', 'user_id__17': '2', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'user_id__18': '2', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__19': 'í˜¸ê°', 'user_id__19': '2', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'user_id__20': '2', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'user_id__21': '2', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'user_id__22': '2', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__23': 'ê¸°ì¨', 'user_id__23': '2', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'user_id__24': '2', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'user_id__25': '2', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°', 'user_id__26': '2'}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s (insertmanyvalues) 1/1 (ordered)] {'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'embed_index__0': None, 'is_delivered__0': 1, 'user_id__0': '1', 'image_url__0': None, 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'has_image__0': 0, 'couple_id__0': '1', 'deleted_at__0': None, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'embed_index__1': None, 'is_delivered__1': 1, 'user_id__1': '2', 'image_url__1': None, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'has_image__1': 0, 'couple_id__1': '1', 'deleted_at__1': None, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'embed_index__2': None, 'is_delivered__2': 1, 'user_id__2': '1', 'image_url__2': None, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'has_image__2': 0, 'couple_id__2': '1', 'deleted_at__2': None, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'embed_index__3': None, 'is_delivered__3': 1, 'user_id__3': '2', 'image_url__3': None, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'has_image__3': 0, 'couple_id__3': '1', 'deleted_at__3': None, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'embed_index__4': None, 'is_delivered__4': 1, 'user_id__4': '2', 'image_url__4': None, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'has_image__4': 0, 'couple_id__4': '1', 'deleted_at__4': None, 'content__5': 'ë¯¸ì•ˆâ€¦ íšŒì˜ ëë‚˜ê³  ë»—ì–´ë²„ë ¸ì–´ ã… ', 'embed_index__5': None, 'is_delivered__5': 1, 'user_id__5': '1', 'image_url__5': None ... 170 parameters truncated ... 'image_url__24': None, 'created_at__24': datetime.datetime(2025, 7, 6, 18, 20), 'has_image__24': 0, 'couple_id__24': '1', 'deleted_at__24': None, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'embed_index__25': None, 'is_delivered__25': 1, 'user_id__25': '2', 'image_url__25': None, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'has_image__25': 0, 'couple_id__25': '1', 'deleted_at__25': None, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'embed_index__26': None, 'is_delivered__26': 1, 'user_id__26': '1', 'image_url__26': None, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'has_image__26': 0, 'couple_id__26': '1', 'deleted_at__26': None, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'embed_index__27': None, 'is_delivered__27': 1, 'user_id__27': '2', 'image_url__27': None, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'has_image__27': 0, 'couple_id__27': '1', 'deleted_at__27': None, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'embed_index__28': None, 'is_delivered__28': 1, 'user_id__28': '1', 'image_url__28': None, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'has_image__28': 0, 'couple_id__28': '1', 'deleted_at__28': None, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'embed_index__29': None, 'is_delivered__29': 1, 'user_id__29': '2', 'image_url__29': None, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'has_image__29': 0, 'couple_id__29': '1', 'deleted_at__29': None}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:28:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:22][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.user_1 = %(user_1_1)s OR couples.user_2 = %(user_2_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:28:22][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'user_1_1': '2', 'user_2_1': '2', 'param_1': 1}
[2025-07-13 23:28:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:22][INFO][sqlalchemy.engine.Engine] SELECT messages.chat_id AS messages_chat_id, messages.user_id AS messages_user_id, messages.couple_id AS messages_couple_id, messages.content AS messages_content, messages.image_url AS messages_image_url, messages.has_image AS messages_has_image, messages.created_at AS messages_created_at, messages.deleted_at AS messages_deleted_at, messages.is_delivered AS messages_is_delivered, messages.embed_index AS messages_embed_index 
FROM messages 
WHERE messages.couple_id = %(couple_id_1)s AND messages.user_id = %(user_id_1)s AND messages.is_delivered = false ORDER BY messages.created_at
[2025-07-13 23:28:22][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'couple_id_1': '1', 'user_id_1': '1'}
[2025-07-13 23:28:22][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:55][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ì•ˆë…•', 'created_at': datetime.datetime(2025, 7, 13, 14, 29, 55, 676585), 'embed_index': None}
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'pk_1': 1}
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] {'user_id_1': '2'}
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] SELECT users.user_id AS users_user_id, users.name AS users_name, users.email AS users_email, users.created_at AS users_created_at, users.deleted_at AS users_deleted_at, users.modified_at AS users_modified_at, users.birth AS users_birth, users.gender AS users_gender 
FROM users 
WHERE users.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] [cached since 0.006342s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] [cached since 0.007723s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:55][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:55][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=3
[2025-07-13 23:28:26][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:28:26][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] [cached since 0.9168s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•ˆë…•í•˜ì„¸ìš”, ìˆ˜ì•„ë‹˜! ì˜¤ëŠ˜ì€ ì–´ë–¤ ë§ˆìŒìœ¼ë¡œ ì˜¤ì…¨ë‚˜ìš”? ğŸ˜Š ê¶ê¸ˆí•œ ê²Œ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ ì£¼ì„¸ìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 28, 26, 253963), 'embed_index': None}
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] [cached since 0.9186s ago] {'pk_1': 2}
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] [cached since 0.9182s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:26][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=2
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] [cached since 0.92s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] [cached since 0.9211s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] [cached since 0.9222s ago] {'user_id_1': '2'}
[2025-07-13 23:28:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] [cached since 17.93s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:43][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] [cached since 17.93s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ë‚¨ìì¹œêµ¬ë‘ ì‹¸ì› ì–´', 'created_at': datetime.datetime(2025, 7, 13, 14, 28, 43, 262460), 'embed_index': None}
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] [cached since 17.93s ago] {'pk_1': 3}
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] [cached since 17.93s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] [cached since 17.93s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:28:43][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:43][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=5
[2025-07-13 23:28:44][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:28:44][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] [cached since 19.09s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì–´ë¨¸, ë§ˆìŒì´ ë§ì´ ë¬´ê±°ìš°ì‹œê² ì–´ìš”. ì–´ë–¤ ì¼ë¡œ ë‹¤íˆ¬ì…¨ëŠ”ì§€ ì €ì—ê²Œ ì¡°ê¸ˆ ë‚˜ëˆ ì£¼ì‹¤ ìˆ˜ ìˆì„ê¹Œìš”? ì œê°€ ë„ì™€ë“œë¦´ ìˆ˜ ìˆëŠ” ë¶€ë¶„ì´ ìˆì„ ê±°ì˜ˆìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 28, 44, 417473), 'embed_index': None}
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] [cached since 19.1s ago] {'pk_1': 4}
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] [cached since 19.1s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:44][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=4
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] [cached since 19.1s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] [cached since 19.1s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] [cached since 19.1s ago] {'user_id_1': '2'}
[2025-07-13 23:28:44][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:11][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:29:11][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:29:11][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [no key 0.00013s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:11][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 29, 12, 164109), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 29, 12, 164112), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 29, 12, 169824)}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00028s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'custom_input__0': None, 'choice_id__0': 2, 'question_id__0': 1, 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 29, 11, 656991), 'user_id__1': '1', 'custom_input__1': None, 'choice_id__1': 8, 'question_id__1': 2, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 29, 11, 657006), 'user_id__2': '1', 'custom_input__2': None, 'choice_id__2': 13, 'question_id__2': 3, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 29, 11, 657014), 'user_id__3': '1', 'custom_input__3': None, 'choice_id__3': 21, 'question_id__3': 4, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 29, 11, 657038), 'user_id__4': '1', 'custom_input__4': None, 'choice_id__4': 26, 'question_id__4': 5, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 29, 11, 657050), 'user_id__5': '2', 'custom_input__5': None, 'choice_id__5': 1, 'question_id__5': 1, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 29, 11, 657057), 'user_id__6': '2', 'custom_input__6': None, 'choice_id__6': 9, 'question_id__6': 2, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 29, 11, 657063), 'user_id__7': '2', 'custom_input__7': None, 'choice_id__7': 16, 'question_id__7': 3, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 29, 11, 657069), 'user_id__8': '2', 'custom_input__8': None, 'choice_id__8': 20, 'question_id__8': 4, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 29, 11, 657075), 'user_id__9': '2', 'custom_input__9': None, 'choice_id__9': 25, 'question_id__9': 5, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 29, 11, 657082)}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__0': 'ê³ ë§ˆì›€', 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'user_id__1': '1', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__2': '1', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'user_id__3': '1', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'user_id__4': '1', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__5': '1', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__6': '1', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'user_id__7': '1', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'user_id__8': '1', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__9': '1', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__9': 'í–‰ë³µ', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'user_id__10': '1', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'user_id__11': '1', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'user_id__12': '1', 'date__12': datetime.datetime(2025, 7, 7, 0, 0) ... 8 parameters truncated ... 'emotion__14': 'ë°”ì¨', 'memo__14': 'ì„œë¡œ ë°”ë¹ ë„ ë„ˆë¥¼ ë– ì˜¬ë¦¬ê²Œ ëì–´.', 'user_id__15': '2', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__16': '2', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'user_id__17': '2', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__17': 'ì´í•´', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'user_id__18': '2', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__19': '2', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__19': 'í˜¸ê°', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'user_id__20': '2', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'user_id__21': '2', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__22': '2', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'user_id__23': '2', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__23': 'ê¸°ì¨', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'user_id__24': '2', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'user_id__25': '2', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__26': '2', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.'}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'couple_id__0': '1', 'has_image__0': 0, 'embed_index__0': None, 'image_url__0': None, 'deleted_at__0': None, 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'is_delivered__0': 1, 'user_id__1': '2', 'couple_id__1': '1', 'has_image__1': 0, 'embed_index__1': None, 'image_url__1': None, 'deleted_at__1': None, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'is_delivered__1': 1, 'user_id__2': '1', 'couple_id__2': '1', 'has_image__2': 0, 'embed_index__2': None, 'image_url__2': None, 'deleted_at__2': None, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'is_delivered__2': 1, 'user_id__3': '2', 'couple_id__3': '1', 'has_image__3': 0, 'embed_index__3': None, 'image_url__3': None, 'deleted_at__3': None, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'is_delivered__3': 1, 'user_id__4': '2', 'couple_id__4': '1', 'has_image__4': 0, 'embed_index__4': None, 'image_url__4': None, 'deleted_at__4': None, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'is_delivered__4': 1, 'user_id__5': '1', 'couple_id__5': '1', 'has_image__5': 0, 'embed_index__5': None, 'image_url__5': None ... 170 parameters truncated ... 'image_url__24': None, 'deleted_at__24': None, 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'created_at__24': datetime.datetime(2025, 7, 6, 18, 20), 'is_delivered__24': 1, 'user_id__25': '2', 'couple_id__25': '1', 'has_image__25': 0, 'embed_index__25': None, 'image_url__25': None, 'deleted_at__25': None, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'is_delivered__25': 1, 'user_id__26': '1', 'couple_id__26': '1', 'has_image__26': 0, 'embed_index__26': None, 'image_url__26': None, 'deleted_at__26': None, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'is_delivered__26': 1, 'user_id__27': '2', 'couple_id__27': '1', 'has_image__27': 0, 'embed_index__27': None, 'image_url__27': None, 'deleted_at__27': None, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'is_delivered__27': 1, 'user_id__28': '1', 'couple_id__28': '1', 'has_image__28': 0, 'embed_index__28': None, 'image_url__28': None, 'deleted_at__28': None, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'is_delivered__28': 1, 'user_id__29': '2', 'couple_id__29': '1', 'has_image__29': 0, 'embed_index__29': None, 'image_url__29': None, 'deleted_at__29': None, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'is_delivered__29': 1}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:14][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ì•ˆë…•', 'created_at': datetime.datetime(2025, 7, 13, 14, 29, 14, 730751), 'embed_index': None}
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'pk_1': 1}
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {'user_id_1': '2'}
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] SELECT users.user_id AS users_user_id, users.name AS users_name, users.email AS users_email, users.created_at AS users_created_at, users.deleted_at AS users_deleted_at, users.modified_at AS users_modified_at, users.birth AS users_birth, users.gender AS users_gender 
FROM users 
WHERE users.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] [cached since 0.006106s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] [cached since 0.007601s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:14][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=3
[2025-07-13 23:29:15][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:29:15][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] [cached since 1.046s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•ˆë…•í•˜ì„¸ìš”, ìˆ˜ì•„ë‹˜ :) ì–´ë–¤ ê³ ë¯¼ì´ë“  í•¨ê»˜ ë‚˜ëˆŒ ì¤€ë¹„ê°€ ë˜ì–´ ìˆì–´ìš”. ë¬´ìŠ¨ ì¼ì´ ìˆì—ˆë‚˜ìš”?', 'created_at': datetime.datetime(2025, 7, 13, 14, 29, 15, 769653), 'embed_index': None}
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] [cached since 1.049s ago] {'pk_1': 2}
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] [cached since 1.05s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:15][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:15][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=2
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] [cached since 16.91s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:31][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] [cached since 16.91s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ë‚¨ìì¹œêµ¬ë‘ ì‹¸ì› ì–´..', 'created_at': datetime.datetime(2025, 7, 13, 14, 29, 31, 637260), 'embed_index': None}
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] [cached since 16.91s ago] {'pk_1': 3}
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] [cached since 16.91s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] [cached since 16.91s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:31][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=5
[2025-07-13 23:29:32][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:29:32][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] [cached since 18.24s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•„ì´ê³ , ë§ˆìŒì´ ë§ì´ ì•„í”„ì‹œê² ì–´ìš”. ì‹¸ìš´ ì´ìœ ëŠ” ë­ì˜€ëŠ”ì§€ ë§ì”€í•´ ì£¼ì‹¤ ìˆ˜ ìˆë‚˜ìš”? ê°™ì´ ì–˜ê¸°í•´ë³´ë©´ ì¢€ ë” ë‚˜ì•„ì§ˆ ìˆ˜ë„ ìˆì§€ ì•Šì„ê¹Œìš”?', 'created_at': datetime.datetime(2025, 7, 13, 14, 29, 32, 965162), 'embed_index': None}
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] [cached since 18.24s ago] {'pk_1': 4}
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] [cached since 18.24s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:29:32][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:29:32][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=4
[2025-07-13 23:29:56][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:29:56][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:29:56][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00011s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00023s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:29:56][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00019s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 29, 57, 112516), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 29, 57, 112519), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 29, 57, 117899)}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00021s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 29, 56, 602785), 'custom_input__0': None, 'user_id__0': '1', 'question_id__0': 1, 'choice_id__0': 2, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 29, 56, 602801), 'custom_input__1': None, 'user_id__1': '1', 'question_id__1': 2, 'choice_id__1': 8, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 29, 56, 602808), 'custom_input__2': None, 'user_id__2': '1', 'question_id__2': 3, 'choice_id__2': 13, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 29, 56, 602815), 'custom_input__3': None, 'user_id__3': '1', 'question_id__3': 4, 'choice_id__3': 21, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 29, 56, 602822), 'custom_input__4': None, 'user_id__4': '1', 'question_id__4': 5, 'choice_id__4': 26, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 29, 56, 602830), 'custom_input__5': None, 'user_id__5': '2', 'question_id__5': 1, 'choice_id__5': 1, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 29, 56, 602836), 'custom_input__6': None, 'user_id__6': '2', 'question_id__6': 2, 'choice_id__6': 9, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 29, 56, 602841), 'custom_input__7': None, 'user_id__7': '2', 'question_id__7': 3, 'choice_id__7': 16, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 29, 56, 602848), 'custom_input__8': None, 'user_id__8': '2', 'question_id__8': 4, 'choice_id__8': 20, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 29, 56, 602854), 'custom_input__9': None, 'user_id__9': '2', 'question_id__9': 5, 'choice_id__9': 25}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__0': 'ê³ ë§ˆì›€', 'user_id__1': '1', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'user_id__2': '1', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'user_id__3': '1', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'user_id__4': '1', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'user_id__5': '1', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'user_id__6': '1', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'user_id__7': '1', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'user_id__8': '1', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'user_id__9': '1', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__9': 'í–‰ë³µ', 'user_id__10': '1', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'user_id__11': '1', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'user_id__12': '1', 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.' ... 8 parameters truncated ... 'date__14': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__14': 'ë°”ì¨', 'user_id__15': '2', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'user_id__16': '2', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'user_id__17': '2', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__17': 'ì´í•´', 'user_id__18': '2', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'user_id__19': '2', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__19': 'í˜¸ê°', 'user_id__20': '2', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'user_id__21': '2', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'user_id__22': '2', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'user_id__23': '2', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__23': 'ê¸°ì¨', 'user_id__24': '2', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'user_id__25': '2', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'user_id__26': '2', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°'}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s (insertmanyvalues) 1/1 (ordered)] {'is_delivered__0': 1, 'has_image__0': 0, 'user_id__0': '1', 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'embed_index__0': None, 'deleted_at__0': None, 'couple_id__0': '1', 'image_url__0': None, 'is_delivered__1': 1, 'has_image__1': 0, 'user_id__1': '2', 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'embed_index__1': None, 'deleted_at__1': None, 'couple_id__1': '1', 'image_url__1': None, 'is_delivered__2': 1, 'has_image__2': 0, 'user_id__2': '1', 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'embed_index__2': None, 'deleted_at__2': None, 'couple_id__2': '1', 'image_url__2': None, 'is_delivered__3': 1, 'has_image__3': 0, 'user_id__3': '2', 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'embed_index__3': None, 'deleted_at__3': None, 'couple_id__3': '1', 'image_url__3': None, 'is_delivered__4': 1, 'has_image__4': 0, 'user_id__4': '2', 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'embed_index__4': None, 'deleted_at__4': None, 'couple_id__4': '1', 'image_url__4': None, 'is_delivered__5': 1, 'has_image__5': 0, 'user_id__5': '1', 'created_at__5': datetime.datetime(2025, 7, 2, 17, 40), 'content__5': 'ë¯¸ì•ˆâ€¦ íšŒì˜ ëë‚˜ê³  ë»—ì–´ë²„ë ¸ì–´ ã… ' ... 170 parameters truncated ... 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'embed_index__24': None, 'deleted_at__24': None, 'couple_id__24': '1', 'image_url__24': None, 'is_delivered__25': 1, 'has_image__25': 0, 'user_id__25': '2', 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'embed_index__25': None, 'deleted_at__25': None, 'couple_id__25': '1', 'image_url__25': None, 'is_delivered__26': 1, 'has_image__26': 0, 'user_id__26': '1', 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'embed_index__26': None, 'deleted_at__26': None, 'couple_id__26': '1', 'image_url__26': None, 'is_delivered__27': 1, 'has_image__27': 0, 'user_id__27': '2', 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'embed_index__27': None, 'deleted_at__27': None, 'couple_id__27': '1', 'image_url__27': None, 'is_delivered__28': 1, 'has_image__28': 0, 'user_id__28': '1', 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'embed_index__28': None, 'deleted_at__28': None, 'couple_id__28': '1', 'image_url__28': None, 'is_delivered__29': 1, 'has_image__29': 0, 'user_id__29': '2', 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'embed_index__29': None, 'deleted_at__29': None, 'couple_id__29': '1', 'image_url__29': None}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:29:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:46][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:30:46][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:30:46][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [generated in 0.00019s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [generated in 0.00023s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [no key 0.00009s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [no key 0.00030s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:30:46][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [no key 0.00024s] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 30, 47, 169214), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 30, 47, 169217), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 30, 47, 174962)}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'choice_id__0': 2, 'custom_input__0': None, 'question_id__0': 1, 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 30, 46, 649349), 'user_id__0': '1', 'choice_id__1': 8, 'custom_input__1': None, 'question_id__1': 2, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 30, 46, 649370), 'user_id__1': '1', 'choice_id__2': 13, 'custom_input__2': None, 'question_id__2': 3, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 30, 46, 649378), 'user_id__2': '1', 'choice_id__3': 21, 'custom_input__3': None, 'question_id__3': 4, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 30, 46, 649385), 'user_id__3': '1', 'choice_id__4': 26, 'custom_input__4': None, 'question_id__4': 5, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 30, 46, 649392), 'user_id__4': '1', 'choice_id__5': 1, 'custom_input__5': None, 'question_id__5': 1, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 30, 46, 649398), 'user_id__5': '2', 'choice_id__6': 9, 'custom_input__6': None, 'question_id__6': 2, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 30, 46, 649403), 'user_id__6': '2', 'choice_id__7': 16, 'custom_input__7': None, 'question_id__7': 3, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 30, 46, 649408), 'user_id__7': '2', 'choice_id__8': 20, 'custom_input__8': None, 'question_id__8': 4, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 30, 46, 649415), 'user_id__8': '2', 'choice_id__9': 25, 'custom_input__9': None, 'question_id__9': 5, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 30, 46, 649421), 'user_id__9': '2'}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__0': 'ê³ ë§ˆì›€', 'user_id__0': '1', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'user_id__1': '1', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'user_id__2': '1', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'user_id__3': '1', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'user_id__4': '1', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'user_id__5': '1', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'user_id__6': '1', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'user_id__7': '1', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'user_id__8': '1', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__9': 'í–‰ë³µ', 'user_id__9': '1', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'user_id__10': '1', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'user_id__11': '1', 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.', 'date__12': datetime.datetime(2025, 7, 7, 0, 0) ... 8 parameters truncated ... 'emotion__14': 'ë°”ì¨', 'user_id__14': '2', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'user_id__15': '2', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'user_id__16': '2', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__17': 'ì´í•´', 'user_id__17': '2', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'user_id__18': '2', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__19': 'í˜¸ê°', 'user_id__19': '2', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'user_id__20': '2', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'user_id__21': '2', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'user_id__22': '2', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__23': 'ê¸°ì¨', 'user_id__23': '2', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'user_id__24': '2', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'user_id__25': '2', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°', 'user_id__26': '2'}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s (insertmanyvalues) 1/1 (ordered)] {'is_delivered__0': 1, 'deleted_at__0': None, 'image_url__0': None, 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'has_image__0': 0, 'embed_index__0': None, 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'couple_id__0': '1', 'user_id__0': '1', 'is_delivered__1': 1, 'deleted_at__1': None, 'image_url__1': None, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'has_image__1': 0, 'embed_index__1': None, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'couple_id__1': '1', 'user_id__1': '2', 'is_delivered__2': 1, 'deleted_at__2': None, 'image_url__2': None, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'has_image__2': 0, 'embed_index__2': None, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'couple_id__2': '1', 'user_id__2': '1', 'is_delivered__3': 1, 'deleted_at__3': None, 'image_url__3': None, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'has_image__3': 0, 'embed_index__3': None, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'couple_id__3': '1', 'user_id__3': '2', 'is_delivered__4': 1, 'deleted_at__4': None, 'image_url__4': None, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'has_image__4': 0, 'embed_index__4': None, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'couple_id__4': '1', 'user_id__4': '2', 'is_delivered__5': 1, 'deleted_at__5': None, 'image_url__5': None, 'content__5': 'ë¯¸ì•ˆâ€¦ íšŒì˜ ëë‚˜ê³  ë»—ì–´ë²„ë ¸ì–´ ã… ', 'has_image__5': 0 ... 170 parameters truncated ... 'has_image__24': 0, 'embed_index__24': None, 'created_at__24': datetime.datetime(2025, 7, 6, 18, 20), 'couple_id__24': '1', 'user_id__24': '1', 'is_delivered__25': 1, 'deleted_at__25': None, 'image_url__25': None, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'has_image__25': 0, 'embed_index__25': None, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'couple_id__25': '1', 'user_id__25': '2', 'is_delivered__26': 1, 'deleted_at__26': None, 'image_url__26': None, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'has_image__26': 0, 'embed_index__26': None, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'couple_id__26': '1', 'user_id__26': '1', 'is_delivered__27': 1, 'deleted_at__27': None, 'image_url__27': None, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'has_image__27': 0, 'embed_index__27': None, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'couple_id__27': '1', 'user_id__27': '2', 'is_delivered__28': 1, 'deleted_at__28': None, 'image_url__28': None, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'has_image__28': 0, 'embed_index__28': None, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'couple_id__28': '1', 'user_id__28': '1', 'is_delivered__29': 1, 'deleted_at__29': None, 'image_url__29': None, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'has_image__29': 0, 'embed_index__29': None, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'couple_id__29': '1', 'user_id__29': '2'}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:30:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:30:59][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:59][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.user_1 = %(user_1_1)s OR couples.user_2 = %(user_2_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:30:59][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'user_1_1': '2', 'user_2_1': '2', 'param_1': 1}
[2025-07-13 23:30:59][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:30:59][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:30:59][INFO][sqlalchemy.engine.Engine] SELECT messages.chat_id AS messages_chat_id, messages.user_id AS messages_user_id, messages.couple_id AS messages_couple_id, messages.content AS messages_content, messages.image_url AS messages_image_url, messages.has_image AS messages_has_image, messages.created_at AS messages_created_at, messages.deleted_at AS messages_deleted_at, messages.is_delivered AS messages_is_delivered, messages.embed_index AS messages_embed_index 
FROM messages 
WHERE messages.couple_id = %(couple_id_1)s AND messages.user_id = %(user_id_1)s AND messages.is_delivered = false ORDER BY messages.created_at
[2025-07-13 23:30:59][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'couple_id_1': '1', 'user_id_1': '1'}
[2025-07-13 23:30:59][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:03][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ì•ˆë…•', 'created_at': datetime.datetime(2025, 7, 13, 14, 31, 3, 47428), 'embed_index': None}
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'pk_1': 1}
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id_1': '2'}
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] SELECT users.user_id AS users_user_id, users.name AS users_name, users.email AS users_email, users.created_at AS users_created_at, users.deleted_at AS users_deleted_at, users.modified_at AS users_modified_at, users.birth AS users_birth, users.gender AS users_gender 
FROM users 
WHERE users.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] [cached since 0.005615s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] [cached since 0.00706s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:03][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=3
[2025-07-13 23:31:04][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:31:04][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] [cached since 1.566s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•ˆë…•í•˜ì„¸ìš”, ìˆ˜ì•„! ì–´ë–»ê²Œ ì§€ë‚´ì…¨ë‚˜ìš”? ìš”ì¦˜ ë§ˆìŒì— ê±¸ë¦¬ëŠ” ì¼ì´ ìˆë‹¤ë©´ í¸í•˜ê²Œ ì–˜ê¸°í•´ ì£¼ì„¸ìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 31, 4, 613884), 'embed_index': None}
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] [cached since 1.57s ago] {'pk_1': 2}
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] [cached since 1.57s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:04][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=2
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] [cached since 1.572s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] [cached since 1.573s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] [cached since 1.574s ago] {'user_id_1': '2'}
[2025-07-13 23:31:04][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] [cached since 23.61s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:26][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] [cached since 23.61s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ìˆ˜ì•„ë‹˜ì´ë¼ê³ í•´ì•¼ì§€', 'created_at': datetime.datetime(2025, 7, 13, 14, 31, 26, 654774), 'embed_index': None}
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] [cached since 23.6s ago] {'pk_1': 3}
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] [cached since 23.6s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] [cached since 23.61s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:26][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=5
[2025-07-13 23:31:28][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:31:28][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] [cached since 25.29s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•—, ë¯¸ì•ˆí•´ìš”, ìˆ˜ì•„ë‹˜! ë‹¤ìŒë¶€í„°ëŠ” ê¼­ ê¸°ì–µí• ê²Œìš”. ìš”ì¦˜ ë§ˆìŒì— ê±¸ë¦¬ëŠ” ì¼ì´ ìˆìœ¼ì‹ ê°€ìš”? ë§ì”€í•´ì£¼ì‹œë©´ ì¢‹ê² ì–´ìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 31, 28, 342558), 'embed_index': None}
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] [cached since 25.3s ago] {'pk_1': 4}
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] [cached since 25.3s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:28][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=4
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] [cached since 25.3s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] [cached since 25.3s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] [cached since 25.3s ago] {'user_id_1': '2'}
[2025-07-13 23:31:28][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:02][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:33:02][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:33:02][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00011s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00033s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [no key 0.00020s] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 33, 2, 910434), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 33, 2, 910437), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 33, 2, 916295)}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'choice_id__0': 2, 'user_id__0': '1', 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 33, 2, 397299), 'custom_input__0': None, 'question_id__0': 1, 'choice_id__1': 8, 'user_id__1': '1', 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 33, 2, 397319), 'custom_input__1': None, 'question_id__1': 2, 'choice_id__2': 13, 'user_id__2': '1', 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 33, 2, 397326), 'custom_input__2': None, 'question_id__2': 3, 'choice_id__3': 21, 'user_id__3': '1', 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 33, 2, 397333), 'custom_input__3': None, 'question_id__3': 4, 'choice_id__4': 26, 'user_id__4': '1', 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 33, 2, 397339), 'custom_input__4': None, 'question_id__4': 5, 'choice_id__5': 1, 'user_id__5': '2', 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 33, 2, 397345), 'custom_input__5': None, 'question_id__5': 1, 'choice_id__6': 9, 'user_id__6': '2', 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 33, 2, 397351), 'custom_input__6': None, 'question_id__6': 2, 'choice_id__7': 16, 'user_id__7': '2', 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 33, 2, 397357), 'custom_input__7': None, 'question_id__7': 3, 'choice_id__8': 20, 'user_id__8': '2', 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 33, 2, 397363), 'custom_input__8': None, 'question_id__8': 4, 'choice_id__9': 25, 'user_id__9': '2', 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 33, 2, 397370), 'custom_input__9': None, 'question_id__9': 5}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'user_id__0': '1', 'emotion__0': 'ê³ ë§ˆì›€', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__1': '1', 'emotion__1': 'ê¸°ëŒ€ê°', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'user_id__2': '1', 'emotion__2': 'ë¯¸ì•ˆí•¨', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'user_id__3': '1', 'emotion__3': 'ì£„ì±…ê°', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__4': '1', 'emotion__4': 'ì‚¬ë‘', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__5': '1', 'emotion__5': 'ë‹¤ì •í•¨', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'user_id__6': '1', 'emotion__6': 'ì¹œë°€ê°', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'user_id__7': '1', 'emotion__7': 'ì–µìš¸í•¨', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__8': '1', 'emotion__8': 'ì„œìš´í•¨', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'user_id__9': '1', 'emotion__9': 'í–‰ë³µ', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'user_id__10': '1', 'emotion__10': 'ê°ì‚¬', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'user_id__11': '1', 'emotion__11': 'ì‹ ë¢°', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.', 'user_id__12': '1' ... 8 parameters truncated ... 'emotion__14': 'ë°”ì¨', 'date__14': datetime.datetime(2025, 7, 1, 0, 0), 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__15': '2', 'emotion__15': 'ì„œìš´í•¨', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'user_id__16': '2', 'emotion__16': 'ì‹¤ë§ê°', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'user_id__17': '2', 'emotion__17': 'ì´í•´', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__18': '2', 'emotion__18': 'ë‹¤ì •í•¨', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'user_id__19': '2', 'emotion__19': 'í˜¸ê°', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'user_id__20': '2', 'emotion__20': 'í¸ì•ˆí•¨', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__21': '2', 'emotion__21': 'ê¸°ëŒ€ê°', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'user_id__22': '2', 'emotion__22': 'ë¶ˆë§Œ', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'user_id__23': '2', 'emotion__23': 'ê¸°ì¨', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'user_id__24': '2', 'emotion__24': 'ê°ë™', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__25': '2', 'emotion__25': 'ì‚¬ë‘', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'user_id__26': '2', 'emotion__26': 'ì•ˆì •ê°', 'date__26': datetime.datetime(2025, 7, 7, 0, 0)}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s (insertmanyvalues) 1/1 (ordered)] {'embed_index__0': None, 'image_url__0': None, 'user_id__0': '1', 'is_delivered__0': 1, 'deleted_at__0': None, 'has_image__0': 0, 'couple_id__0': '1', 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'embed_index__1': None, 'image_url__1': None, 'user_id__1': '2', 'is_delivered__1': 1, 'deleted_at__1': None, 'has_image__1': 0, 'couple_id__1': '1', 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'embed_index__2': None, 'image_url__2': None, 'user_id__2': '1', 'is_delivered__2': 1, 'deleted_at__2': None, 'has_image__2': 0, 'couple_id__2': '1', 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'embed_index__3': None, 'image_url__3': None, 'user_id__3': '2', 'is_delivered__3': 1, 'deleted_at__3': None, 'has_image__3': 0, 'couple_id__3': '1', 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'embed_index__4': None, 'image_url__4': None, 'user_id__4': '2', 'is_delivered__4': 1, 'deleted_at__4': None, 'has_image__4': 0, 'couple_id__4': '1', 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'embed_index__5': None, 'image_url__5': None, 'user_id__5': '1', 'is_delivered__5': 1, 'deleted_at__5': None ... 170 parameters truncated ... 'deleted_at__24': None, 'has_image__24': 0, 'couple_id__24': '1', 'created_at__24': datetime.datetime(2025, 7, 6, 18, 20), 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'embed_index__25': None, 'image_url__25': None, 'user_id__25': '2', 'is_delivered__25': 1, 'deleted_at__25': None, 'has_image__25': 0, 'couple_id__25': '1', 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'embed_index__26': None, 'image_url__26': None, 'user_id__26': '1', 'is_delivered__26': 1, 'deleted_at__26': None, 'has_image__26': 0, 'couple_id__26': '1', 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'embed_index__27': None, 'image_url__27': None, 'user_id__27': '2', 'is_delivered__27': 1, 'deleted_at__27': None, 'has_image__27': 0, 'couple_id__27': '1', 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'embed_index__28': None, 'image_url__28': None, 'user_id__28': '1', 'is_delivered__28': 1, 'deleted_at__28': None, 'has_image__28': 0, 'couple_id__28': '1', 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'embed_index__29': None, 'image_url__29': None, 'user_id__29': '2', 'is_delivered__29': 1, 'deleted_at__29': None, 'has_image__29': 0, 'couple_id__29': '1', 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜'}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:09][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ì•ˆë…•', 'created_at': datetime.datetime(2025, 7, 13, 14, 33, 9, 10759), 'embed_index': None}
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'pk_1': 1}
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] [cached since 0.001492s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:09][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:09][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=7
[2025-07-13 23:33:10][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:33:10][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] [cached since 1.192s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•ˆë…•í•˜ì„¸ìš”, ìˆ˜ì•„ë‹˜! ì˜¤ëŠ˜ì€ ì–´ë–¤ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? í˜¹ì‹œ ë§ˆìŒì— ê³ ë¯¼ì´ ìˆìœ¼ì‹œë‹¤ë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ ì£¼ì„¸ìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 33, 10, 202737), 'embed_index': None}
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] [cached since 1.196s ago] {'pk_1': 2}
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] [cached since 1.196s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:10][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=2
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] [cached since 1.198s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] [cached since 1.199s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] [generated in 0.00009s] {'user_id_1': '2'}
[2025-07-13 23:33:10][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:26][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:33:26][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:33:26][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [generated in 0.00037s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00011s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:33:26][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 33, 27, 111209), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 33, 27, 111211), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 33, 27, 117011)}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [generated in 0.00008s (insertmanyvalues) 1/1 (ordered)] {'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 33, 26, 609884), 'question_id__0': 1, 'user_id__0': '1', 'custom_input__0': None, 'choice_id__0': 2, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 33, 26, 609901), 'question_id__1': 2, 'user_id__1': '1', 'custom_input__1': None, 'choice_id__1': 8, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 33, 26, 610013), 'question_id__2': 3, 'user_id__2': '1', 'custom_input__2': None, 'choice_id__2': 13, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 33, 26, 610025), 'question_id__3': 4, 'user_id__3': '1', 'custom_input__3': None, 'choice_id__3': 21, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 33, 26, 610033), 'question_id__4': 5, 'user_id__4': '1', 'custom_input__4': None, 'choice_id__4': 26, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 33, 26, 610040), 'question_id__5': 1, 'user_id__5': '2', 'custom_input__5': None, 'choice_id__5': 1, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 33, 26, 610045), 'question_id__6': 2, 'user_id__6': '2', 'custom_input__6': None, 'choice_id__6': 9, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 33, 26, 610051), 'question_id__7': 3, 'user_id__7': '2', 'custom_input__7': None, 'choice_id__7': 16, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 33, 26, 610057), 'question_id__8': 4, 'user_id__8': '2', 'custom_input__8': None, 'choice_id__8': 20, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 33, 26, 610063), 'question_id__9': 5, 'user_id__9': '2', 'custom_input__9': None, 'choice_id__9': 25}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__0': '1', 'emotion__0': 'ê³ ë§ˆì›€', 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__1': '1', 'emotion__1': 'ê¸°ëŒ€ê°', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__2': '1', 'emotion__2': 'ë¯¸ì•ˆí•¨', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__3': '1', 'emotion__3': 'ì£„ì±…ê°', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__4': '1', 'emotion__4': 'ì‚¬ë‘', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__5': '1', 'emotion__5': 'ë‹¤ì •í•¨', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__6': '1', 'emotion__6': 'ì¹œë°€ê°', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__7': '1', 'emotion__7': 'ì–µìš¸í•¨', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__8': '1', 'emotion__8': 'ì„œìš´í•¨', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__9': '1', 'emotion__9': 'í–‰ë³µ', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__10': '1', 'emotion__10': 'ê°ì‚¬', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__11': '1', 'emotion__11': 'ì‹ ë¢°', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__12': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__12': '1' ... 8 parameters truncated ... 'emotion__14': 'ë°”ì¨', 'memo__14': 'ì„œë¡œ ë°”ë¹ ë„ ë„ˆë¥¼ ë– ì˜¬ë¦¬ê²Œ ëì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__15': '2', 'emotion__15': 'ì„œìš´í•¨', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__16': '2', 'emotion__16': 'ì‹¤ë§ê°', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__17': '2', 'emotion__17': 'ì´í•´', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__18': '2', 'emotion__18': 'ë‹¤ì •í•¨', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__19': '2', 'emotion__19': 'í˜¸ê°', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__20': '2', 'emotion__20': 'í¸ì•ˆí•¨', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__21': '2', 'emotion__21': 'ê¸°ëŒ€ê°', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__22': '2', 'emotion__22': 'ë¶ˆë§Œ', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__23': '2', 'emotion__23': 'ê¸°ì¨', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__24': '2', 'emotion__24': 'ê°ë™', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__25': '2', 'emotion__25': 'ì‚¬ë‘', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__26': '2', 'emotion__26': 'ì•ˆì •ê°', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.'}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s (insertmanyvalues) 1/1 (ordered)] {'is_delivered__0': 1, 'has_image__0': 0, 'couple_id__0': '1', 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'user_id__0': '1', 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'embed_index__0': None, 'deleted_at__0': None, 'image_url__0': None, 'is_delivered__1': 1, 'has_image__1': 0, 'couple_id__1': '1', 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'user_id__1': '2', 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'embed_index__1': None, 'deleted_at__1': None, 'image_url__1': None, 'is_delivered__2': 1, 'has_image__2': 0, 'couple_id__2': '1', 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'user_id__2': '1', 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'embed_index__2': None, 'deleted_at__2': None, 'image_url__2': None, 'is_delivered__3': 1, 'has_image__3': 0, 'couple_id__3': '1', 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'user_id__3': '2', 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'embed_index__3': None, 'deleted_at__3': None, 'image_url__3': None, 'is_delivered__4': 1, 'has_image__4': 0, 'couple_id__4': '1', 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'user_id__4': '2', 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'embed_index__4': None, 'deleted_at__4': None, 'image_url__4': None, 'is_delivered__5': 1, 'has_image__5': 0, 'couple_id__5': '1', 'content__5': 'ë¯¸ì•ˆâ€¦ íšŒì˜ ëë‚˜ê³  ë»—ì–´ë²„ë ¸ì–´ ã… ', 'user_id__5': '1' ... 170 parameters truncated ... 'user_id__24': '1', 'created_at__24': datetime.datetime(2025, 7, 6, 18, 20), 'embed_index__24': None, 'deleted_at__24': None, 'image_url__24': None, 'is_delivered__25': 1, 'has_image__25': 0, 'couple_id__25': '1', 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'user_id__25': '2', 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'embed_index__25': None, 'deleted_at__25': None, 'image_url__25': None, 'is_delivered__26': 1, 'has_image__26': 0, 'couple_id__26': '1', 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'user_id__26': '1', 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'embed_index__26': None, 'deleted_at__26': None, 'image_url__26': None, 'is_delivered__27': 1, 'has_image__27': 0, 'couple_id__27': '1', 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'user_id__27': '2', 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'embed_index__27': None, 'deleted_at__27': None, 'image_url__27': None, 'is_delivered__28': 1, 'has_image__28': 0, 'couple_id__28': '1', 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'user_id__28': '1', 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'embed_index__28': None, 'deleted_at__28': None, 'image_url__28': None, 'is_delivered__29': 1, 'has_image__29': 0, 'couple_id__29': '1', 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'user_id__29': '2', 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'embed_index__29': None, 'deleted_at__29': None, 'image_url__29': None}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:31][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ì•ˆë…•~', 'created_at': datetime.datetime(2025, 7, 13, 14, 33, 31, 906735), 'embed_index': None}
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'pk_1': 1}
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id_1': '2'}
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] SELECT users.user_id AS users_user_id, users.name AS users_name, users.email AS users_email, users.created_at AS users_created_at, users.deleted_at AS users_deleted_at, users.modified_at AS users_modified_at, users.birth AS users_birth, users.gender AS users_gender 
FROM users 
WHERE users.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] [cached since 0.005439s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] [cached since 0.007025s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:31][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=3
[2025-07-13 23:33:32][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:33:32][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] [cached since 1.025s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•ˆë…•í•˜ì„¸ìš”, ìˆ˜ì•„! ì˜¤ëŠ˜ ê¸°ë¶„ì€ ì–´ë– ì‹ ê°€ìš”? ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ ì£¼ì„¸ìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 33, 32, 931598), 'embed_index': None}
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] [cached since 1.028s ago] {'pk_1': 2}
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] [cached since 1.027s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:32][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=2
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] [cached since 1.029s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] [cached since 1.031s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] [cached since 1.031s ago] {'user_id_1': '2'}
[2025-07-13 23:33:32][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:33:46][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:33:46][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:33:46][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:33:46][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00009s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00015s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00022s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 33, 47, 437795), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 33, 47, 437798), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 33, 47, 443543)}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'question_id__0': 1, 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 33, 46, 926348), 'custom_input__0': None, 'choice_id__0': 2, 'user_id__0': '1', 'question_id__1': 2, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 33, 46, 926366), 'custom_input__1': None, 'choice_id__1': 8, 'user_id__1': '1', 'question_id__2': 3, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 33, 46, 926374), 'custom_input__2': None, 'choice_id__2': 13, 'user_id__2': '1', 'question_id__3': 4, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 33, 46, 926381), 'custom_input__3': None, 'choice_id__3': 21, 'user_id__3': '1', 'question_id__4': 5, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 33, 46, 926388), 'custom_input__4': None, 'choice_id__4': 26, 'user_id__4': '1', 'question_id__5': 1, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 33, 46, 926394), 'custom_input__5': None, 'choice_id__5': 1, 'user_id__5': '2', 'question_id__6': 2, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 33, 46, 926401), 'custom_input__6': None, 'choice_id__6': 9, 'user_id__6': '2', 'question_id__7': 3, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 33, 46, 926407), 'custom_input__7': None, 'choice_id__7': 16, 'user_id__7': '2', 'question_id__8': 4, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 33, 46, 926413), 'custom_input__8': None, 'choice_id__8': 20, 'user_id__8': '2', 'question_id__9': 5, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 33, 46, 926420), 'custom_input__9': None, 'choice_id__9': 25, 'user_id__9': '2'}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00007s (insertmanyvalues) 1/1 (ordered)] {'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__0': 'ê³ ë§ˆì›€', 'user_id__0': '1', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'user_id__1': '1', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'user_id__2': '1', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'user_id__3': '1', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'user_id__4': '1', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'user_id__5': '1', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'user_id__6': '1', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'user_id__7': '1', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'user_id__8': '1', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__9': 'í–‰ë³µ', 'user_id__9': '1', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'user_id__10': '1', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'user_id__11': '1', 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.', 'date__12': datetime.datetime(2025, 7, 7, 0, 0) ... 8 parameters truncated ... 'emotion__14': 'ë°”ì¨', 'user_id__14': '2', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'user_id__15': '2', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'user_id__16': '2', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__17': 'ì´í•´', 'user_id__17': '2', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'user_id__18': '2', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__19': 'í˜¸ê°', 'user_id__19': '2', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'user_id__20': '2', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'user_id__21': '2', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'user_id__22': '2', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__23': 'ê¸°ì¨', 'user_id__23': '2', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'user_id__24': '2', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'user_id__25': '2', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°', 'user_id__26': '2'}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'image_url__0': None, 'embed_index__0': None, 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'deleted_at__0': None, 'is_delivered__0': 1, 'couple_id__0': '1', 'has_image__0': 0, 'user_id__1': '2', 'image_url__1': None, 'embed_index__1': None, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'deleted_at__1': None, 'is_delivered__1': 1, 'couple_id__1': '1', 'has_image__1': 0, 'user_id__2': '1', 'image_url__2': None, 'embed_index__2': None, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'deleted_at__2': None, 'is_delivered__2': 1, 'couple_id__2': '1', 'has_image__2': 0, 'user_id__3': '2', 'image_url__3': None, 'embed_index__3': None, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'deleted_at__3': None, 'is_delivered__3': 1, 'couple_id__3': '1', 'has_image__3': 0, 'user_id__4': '2', 'image_url__4': None, 'embed_index__4': None, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'deleted_at__4': None, 'is_delivered__4': 1, 'couple_id__4': '1', 'has_image__4': 0, 'user_id__5': '1', 'image_url__5': None, 'embed_index__5': None, 'created_at__5': datetime.datetime(2025, 7, 2, 17, 40), 'content__5': 'ë¯¸ì•ˆâ€¦ íšŒì˜ ëë‚˜ê³  ë»—ì–´ë²„ë ¸ì–´ ã… ' ... 170 parameters truncated ... 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'deleted_at__24': None, 'is_delivered__24': 1, 'couple_id__24': '1', 'has_image__24': 0, 'user_id__25': '2', 'image_url__25': None, 'embed_index__25': None, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'deleted_at__25': None, 'is_delivered__25': 1, 'couple_id__25': '1', 'has_image__25': 0, 'user_id__26': '1', 'image_url__26': None, 'embed_index__26': None, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'deleted_at__26': None, 'is_delivered__26': 1, 'couple_id__26': '1', 'has_image__26': 0, 'user_id__27': '2', 'image_url__27': None, 'embed_index__27': None, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'deleted_at__27': None, 'is_delivered__27': 1, 'couple_id__27': '1', 'has_image__27': 0, 'user_id__28': '1', 'image_url__28': None, 'embed_index__28': None, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'deleted_at__28': None, 'is_delivered__28': 1, 'couple_id__28': '1', 'has_image__28': 0, 'user_id__29': '2', 'image_url__29': None, 'embed_index__29': None, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'deleted_at__29': None, 'is_delivered__29': 1, 'couple_id__29': '1', 'has_image__29': 0}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:33:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:52][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:35:52][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:35:52][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [generated in 0.00022s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00012s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00026s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:35:52][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 35, 53, 62760), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 35, 53, 62763), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 35, 53, 68348)}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [generated in 0.00028s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 35, 52, 545509), 'question_id__0': 1, 'choice_id__0': 2, 'custom_input__0': None, 'user_id__0': '1', 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 35, 52, 545524), 'question_id__1': 2, 'choice_id__1': 8, 'custom_input__1': None, 'user_id__1': '1', 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 35, 52, 545531), 'question_id__2': 3, 'choice_id__2': 13, 'custom_input__2': None, 'user_id__2': '1', 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 35, 52, 545538), 'question_id__3': 4, 'choice_id__3': 21, 'custom_input__3': None, 'user_id__3': '1', 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 35, 52, 545545), 'question_id__4': 5, 'choice_id__4': 26, 'custom_input__4': None, 'user_id__4': '1', 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 35, 52, 545551), 'question_id__5': 1, 'choice_id__5': 1, 'custom_input__5': None, 'user_id__5': '2', 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 35, 52, 545556), 'question_id__6': 2, 'choice_id__6': 9, 'custom_input__6': None, 'user_id__6': '2', 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 35, 52, 545562), 'question_id__7': 3, 'choice_id__7': 16, 'custom_input__7': None, 'user_id__7': '2', 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 35, 52, 545568), 'question_id__8': 4, 'choice_id__8': 20, 'custom_input__8': None, 'user_id__8': '2', 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 35, 52, 545574), 'question_id__9': 5, 'choice_id__9': 25, 'custom_input__9': None, 'user_id__9': '2'}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'user_id__0': '1', 'emotion__0': 'ê³ ë§ˆì›€', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__1': '1', 'emotion__1': 'ê¸°ëŒ€ê°', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'user_id__2': '1', 'emotion__2': 'ë¯¸ì•ˆí•¨', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'user_id__3': '1', 'emotion__3': 'ì£„ì±…ê°', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__4': '1', 'emotion__4': 'ì‚¬ë‘', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__5': '1', 'emotion__5': 'ë‹¤ì •í•¨', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'user_id__6': '1', 'emotion__6': 'ì¹œë°€ê°', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'user_id__7': '1', 'emotion__7': 'ì–µìš¸í•¨', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__8': '1', 'emotion__8': 'ì„œìš´í•¨', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'user_id__9': '1', 'emotion__9': 'í–‰ë³µ', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'user_id__10': '1', 'emotion__10': 'ê°ì‚¬', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'user_id__11': '1', 'emotion__11': 'ì‹ ë¢°', 'date__12': datetime.datetime(2025, 7, 7, 0, 0), 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.' ... 8 parameters truncated ... 'user_id__14': '2', 'emotion__14': 'ë°”ì¨', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__15': '2', 'emotion__15': 'ì„œìš´í•¨', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'user_id__16': '2', 'emotion__16': 'ì‹¤ë§ê°', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'user_id__17': '2', 'emotion__17': 'ì´í•´', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__18': '2', 'emotion__18': 'ë‹¤ì •í•¨', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'user_id__19': '2', 'emotion__19': 'í˜¸ê°', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'user_id__20': '2', 'emotion__20': 'í¸ì•ˆí•¨', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__21': '2', 'emotion__21': 'ê¸°ëŒ€ê°', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'user_id__22': '2', 'emotion__22': 'ë¶ˆë§Œ', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'user_id__23': '2', 'emotion__23': 'ê¸°ì¨', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'user_id__24': '2', 'emotion__24': 'ê°ë™', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__25': '2', 'emotion__25': 'ì‚¬ë‘', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'user_id__26': '2', 'emotion__26': 'ì•ˆì •ê°'}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s (insertmanyvalues) 1/1 (ordered)] {'couple_id__0': '1', 'has_image__0': 0, 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'deleted_at__0': None, 'embed_index__0': None, 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'is_delivered__0': 1, 'user_id__0': '1', 'image_url__0': None, 'couple_id__1': '1', 'has_image__1': 0, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'deleted_at__1': None, 'embed_index__1': None, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'is_delivered__1': 1, 'user_id__1': '2', 'image_url__1': None, 'couple_id__2': '1', 'has_image__2': 0, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'deleted_at__2': None, 'embed_index__2': None, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'is_delivered__2': 1, 'user_id__2': '1', 'image_url__2': None, 'couple_id__3': '1', 'has_image__3': 0, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'deleted_at__3': None, 'embed_index__3': None, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'is_delivered__3': 1, 'user_id__3': '2', 'image_url__3': None, 'couple_id__4': '1', 'has_image__4': 0, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'deleted_at__4': None, 'embed_index__4': None, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'is_delivered__4': 1, 'user_id__4': '2', 'image_url__4': None, 'couple_id__5': '1', 'has_image__5': 0, 'created_at__5': datetime.datetime(2025, 7, 2, 17, 40), 'deleted_at__5': None, 'embed_index__5': None ... 170 parameters truncated ... 'embed_index__24': None, 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'is_delivered__24': 1, 'user_id__24': '1', 'image_url__24': None, 'couple_id__25': '1', 'has_image__25': 0, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'deleted_at__25': None, 'embed_index__25': None, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'is_delivered__25': 1, 'user_id__25': '2', 'image_url__25': None, 'couple_id__26': '1', 'has_image__26': 0, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'deleted_at__26': None, 'embed_index__26': None, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'is_delivered__26': 1, 'user_id__26': '1', 'image_url__26': None, 'couple_id__27': '1', 'has_image__27': 0, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'deleted_at__27': None, 'embed_index__27': None, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'is_delivered__27': 1, 'user_id__27': '2', 'image_url__27': None, 'couple_id__28': '1', 'has_image__28': 0, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'deleted_at__28': None, 'embed_index__28': None, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'is_delivered__28': 1, 'user_id__28': '1', 'image_url__28': None, 'couple_id__29': '1', 'has_image__29': 0, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'deleted_at__29': None, 'embed_index__29': None, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'is_delivered__29': 1, 'user_id__29': '2', 'image_url__29': None}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:35:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:02][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ì•ˆë…•~', 'created_at': datetime.datetime(2025, 7, 13, 14, 36, 2, 385179), 'embed_index': None}
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] {'pk_1': 1}
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'user_id_1': '2'}
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] SELECT users.user_id AS users_user_id, users.name AS users_name, users.email AS users_email, users.created_at AS users_created_at, users.deleted_at AS users_deleted_at, users.modified_at AS users_modified_at, users.birth AS users_birth, users.gender AS users_gender 
FROM users 
WHERE users.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00024s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] [cached since 0.006413s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] [cached since 0.00806s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:02][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:02][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=3
[2025-07-13 23:36:03][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:36:03][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] [cached since 1.279s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•ˆë…•í•˜ì„¸ìš”, ìˆ˜ì•„ë‹˜~ ì˜¤ëŠ˜ ê¸°ë¶„ì´ ì–´ë– ì‹ ê°€ìš”? ê¶ê¸ˆí•œ ê²Œ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ ì£¼ì„¸ìš”. :)', 'created_at': datetime.datetime(2025, 7, 13, 14, 36, 3, 664236), 'embed_index': None}
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] [cached since 1.282s ago] {'pk_1': 2}
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] [cached since 1.282s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:03][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=2
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] [cached since 1.284s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] [cached since 1.285s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] [cached since 1.285s ago] {'user_id_1': '2'}
[2025-07-13 23:36:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:13][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:36:13][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:36:13][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] [generated in 0.00023s] {}
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:36:13][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00011s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00020s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 36, 14, 415944), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 36, 14, 415947), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 36, 14, 424377)}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00019s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'choice_id__0': 2, 'user_id__0': '1', 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 36, 13, 898836), 'custom_input__0': None, 'question_id__0': 1, 'choice_id__1': 8, 'user_id__1': '1', 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 36, 13, 898870), 'custom_input__1': None, 'question_id__1': 2, 'choice_id__2': 13, 'user_id__2': '1', 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 36, 13, 898880), 'custom_input__2': None, 'question_id__2': 3, 'choice_id__3': 21, 'user_id__3': '1', 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 36, 13, 898953), 'custom_input__3': None, 'question_id__3': 4, 'choice_id__4': 26, 'user_id__4': '1', 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 36, 13, 898966), 'custom_input__4': None, 'question_id__4': 5, 'choice_id__5': 1, 'user_id__5': '2', 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 36, 13, 898974), 'custom_input__5': None, 'question_id__5': 1, 'choice_id__6': 9, 'user_id__6': '2', 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 36, 13, 898980), 'custom_input__6': None, 'question_id__6': 2, 'choice_id__7': 16, 'user_id__7': '2', 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 36, 13, 898986), 'custom_input__7': None, 'question_id__7': 3, 'choice_id__8': 20, 'user_id__8': '2', 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 36, 13, 898994), 'custom_input__8': None, 'question_id__8': 4, 'choice_id__9': 25, 'user_id__9': '2', 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 36, 13, 899001), 'custom_input__9': None, 'question_id__9': 5}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'emotion__0': 'ê³ ë§ˆì›€', 'user_id__0': '1', 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'user_id__1': '1', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'user_id__2': '1', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'user_id__3': '1', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'user_id__4': '1', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'user_id__5': '1', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'user_id__6': '1', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'user_id__7': '1', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'user_id__8': '1', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__9': 'í–‰ë³µ', 'user_id__9': '1', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'user_id__10': '1', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'user_id__11': '1', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__12': 'ì• ì •', 'user_id__12': '1' ... 8 parameters truncated ... 'memo__14': 'ì„œë¡œ ë°”ë¹ ë„ ë„ˆë¥¼ ë– ì˜¬ë¦¬ê²Œ ëì–´.', 'date__14': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'user_id__15': '2', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'user_id__16': '2', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__17': 'ì´í•´', 'user_id__17': '2', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'user_id__18': '2', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__19': 'í˜¸ê°', 'user_id__19': '2', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'user_id__20': '2', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'user_id__21': '2', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'user_id__22': '2', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__23': 'ê¸°ì¨', 'user_id__23': '2', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'user_id__24': '2', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'user_id__25': '2', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°', 'user_id__26': '2', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0)}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s (insertmanyvalues) 1/1 (ordered)] {'couple_id__0': '1', 'has_image__0': 0, 'user_id__0': '1', 'is_delivered__0': 1, 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'deleted_at__0': None, 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'image_url__0': None, 'embed_index__0': None, 'couple_id__1': '1', 'has_image__1': 0, 'user_id__1': '2', 'is_delivered__1': 1, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'deleted_at__1': None, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'image_url__1': None, 'embed_index__1': None, 'couple_id__2': '1', 'has_image__2': 0, 'user_id__2': '1', 'is_delivered__2': 1, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'deleted_at__2': None, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'image_url__2': None, 'embed_index__2': None, 'couple_id__3': '1', 'has_image__3': 0, 'user_id__3': '2', 'is_delivered__3': 1, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'deleted_at__3': None, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'image_url__3': None, 'embed_index__3': None, 'couple_id__4': '1', 'has_image__4': 0, 'user_id__4': '2', 'is_delivered__4': 1, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'deleted_at__4': None, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'image_url__4': None, 'embed_index__4': None, 'couple_id__5': '1', 'has_image__5': 0, 'user_id__5': '1', 'is_delivered__5': 1, 'created_at__5': datetime.datetime(2025, 7, 2, 17, 40) ... 170 parameters truncated ... 'created_at__24': datetime.datetime(2025, 7, 6, 18, 20), 'deleted_at__24': None, 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'image_url__24': None, 'embed_index__24': None, 'couple_id__25': '1', 'has_image__25': 0, 'user_id__25': '2', 'is_delivered__25': 1, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'deleted_at__25': None, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'image_url__25': None, 'embed_index__25': None, 'couple_id__26': '1', 'has_image__26': 0, 'user_id__26': '1', 'is_delivered__26': 1, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'deleted_at__26': None, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'image_url__26': None, 'embed_index__26': None, 'couple_id__27': '1', 'has_image__27': 0, 'user_id__27': '2', 'is_delivered__27': 1, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'deleted_at__27': None, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'image_url__27': None, 'embed_index__27': None, 'couple_id__28': '1', 'has_image__28': 0, 'user_id__28': '1', 'is_delivered__28': 1, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'deleted_at__28': None, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'image_url__28': None, 'embed_index__28': None, 'couple_id__29': '1', 'has_image__29': 0, 'user_id__29': '2', 'is_delivered__29': 1, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'deleted_at__29': None, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'image_url__29': None, 'embed_index__29': None}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:20][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'hello', 'created_at': datetime.datetime(2025, 7, 13, 14, 36, 20, 162483), 'embed_index': None}
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] [generated in 0.00048s] {'pk_1': 1}
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] [generated in 0.00037s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] [generated in 0.00019s] {'user_id_1': '2'}
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] [generated in 0.00009s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] SELECT users.user_id AS users_user_id, users.name AS users_name, users.email AS users_email, users.created_at AS users_created_at, users.deleted_at AS users_deleted_at, users.modified_at AS users_modified_at, users.birth AS users_birth, users.gender AS users_gender 
FROM users 
WHERE users.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] [cached since 0.007795s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] [cached since 0.009184s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:20][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:20][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=3
[2025-07-13 23:36:22][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:36:22][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] [cached since 1.87s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'Hello ìˆ˜ì•„ë‹˜! How are you today? If you have any relationship questions, feel free to ask. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 36, 22, 26913), 'embed_index': None}
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] [cached since 1.872s ago] {'pk_1': 2}
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] [cached since 1.87s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:22][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=2
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] [cached since 1.872s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] [cached since 1.873s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] [cached since 1.873s ago] {'user_id_1': '2'}
[2025-07-13 23:36:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:36:57][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:36:57][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:36:57][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00022s] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00047s] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [no key 0.00012s] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:36:57][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 36, 58, 286553), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 36, 58, 286556), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 36, 58, 294348)}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [generated in 0.00019s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'choice_id__0': 2, 'user_id__0': '1', 'custom_input__0': None, 'question_id__0': 1, 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 36, 57, 783851), 'choice_id__1': 8, 'user_id__1': '1', 'custom_input__1': None, 'question_id__1': 2, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 36, 57, 783866), 'choice_id__2': 13, 'user_id__2': '1', 'custom_input__2': None, 'question_id__2': 3, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 36, 57, 783874), 'choice_id__3': 21, 'user_id__3': '1', 'custom_input__3': None, 'question_id__3': 4, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 36, 57, 783881), 'choice_id__4': 26, 'user_id__4': '1', 'custom_input__4': None, 'question_id__4': 5, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 36, 57, 783888), 'choice_id__5': 1, 'user_id__5': '2', 'custom_input__5': None, 'question_id__5': 1, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 36, 57, 783894), 'choice_id__6': 9, 'user_id__6': '2', 'custom_input__6': None, 'question_id__6': 2, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 36, 57, 783899), 'choice_id__7': 16, 'user_id__7': '2', 'custom_input__7': None, 'question_id__7': 3, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 36, 57, 783906), 'choice_id__8': 20, 'user_id__8': '2', 'custom_input__8': None, 'question_id__8': 4, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 36, 57, 783912), 'choice_id__9': 25, 'user_id__9': '2', 'custom_input__9': None, 'question_id__9': 5, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 36, 57, 783919)}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'emotion__0': 'ê³ ë§ˆì›€', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'user_id__1': '1', 'emotion__1': 'ê¸°ëŒ€ê°', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__2': '1', 'emotion__2': 'ë¯¸ì•ˆí•¨', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'user_id__3': '1', 'emotion__3': 'ì£„ì±…ê°', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'user_id__4': '1', 'emotion__4': 'ì‚¬ë‘', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__5': '1', 'emotion__5': 'ë‹¤ì •í•¨', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__6': '1', 'emotion__6': 'ì¹œë°€ê°', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'user_id__7': '1', 'emotion__7': 'ì–µìš¸í•¨', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'user_id__8': '1', 'emotion__8': 'ì„œìš´í•¨', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__9': '1', 'emotion__9': 'í–‰ë³µ', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'user_id__10': '1', 'emotion__10': 'ê°ì‚¬', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'user_id__11': '1', 'emotion__11': 'ì‹ ë¢°', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'user_id__12': '1', 'emotion__12': 'ì• ì •' ... 8 parameters truncated ... 'date__14': datetime.datetime(2025, 7, 1, 0, 0), 'memo__14': 'ì„œë¡œ ë°”ë¹ ë„ ë„ˆë¥¼ ë– ì˜¬ë¦¬ê²Œ ëì–´.', 'user_id__15': '2', 'emotion__15': 'ì„œìš´í•¨', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__16': '2', 'emotion__16': 'ì‹¤ë§ê°', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'user_id__17': '2', 'emotion__17': 'ì´í•´', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'user_id__18': '2', 'emotion__18': 'ë‹¤ì •í•¨', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__19': '2', 'emotion__19': 'í˜¸ê°', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'user_id__20': '2', 'emotion__20': 'í¸ì•ˆí•¨', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'user_id__21': '2', 'emotion__21': 'ê¸°ëŒ€ê°', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__22': '2', 'emotion__22': 'ë¶ˆë§Œ', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'user_id__23': '2', 'emotion__23': 'ê¸°ì¨', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'user_id__24': '2', 'emotion__24': 'ê°ë™', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'user_id__25': '2', 'emotion__25': 'ì‚¬ë‘', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__26': '2', 'emotion__26': 'ì•ˆì •ê°', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.'}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s (insertmanyvalues) 1/1 (ordered)] {'couple_id__0': '1', 'user_id__0': '1', 'embed_index__0': None, 'has_image__0': 0, 'deleted_at__0': None, 'image_url__0': None, 'is_delivered__0': 1, 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'couple_id__1': '1', 'user_id__1': '2', 'embed_index__1': None, 'has_image__1': 0, 'deleted_at__1': None, 'image_url__1': None, 'is_delivered__1': 1, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'couple_id__2': '1', 'user_id__2': '1', 'embed_index__2': None, 'has_image__2': 0, 'deleted_at__2': None, 'image_url__2': None, 'is_delivered__2': 1, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'couple_id__3': '1', 'user_id__3': '2', 'embed_index__3': None, 'has_image__3': 0, 'deleted_at__3': None, 'image_url__3': None, 'is_delivered__3': 1, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'couple_id__4': '1', 'user_id__4': '2', 'embed_index__4': None, 'has_image__4': 0, 'deleted_at__4': None, 'image_url__4': None, 'is_delivered__4': 1, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'couple_id__5': '1', 'user_id__5': '1', 'embed_index__5': None, 'has_image__5': 0, 'deleted_at__5': None ... 170 parameters truncated ... 'deleted_at__24': None, 'image_url__24': None, 'is_delivered__24': 1, 'created_at__24': datetime.datetime(2025, 7, 6, 18, 20), 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'couple_id__25': '1', 'user_id__25': '2', 'embed_index__25': None, 'has_image__25': 0, 'deleted_at__25': None, 'image_url__25': None, 'is_delivered__25': 1, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'couple_id__26': '1', 'user_id__26': '1', 'embed_index__26': None, 'has_image__26': 0, 'deleted_at__26': None, 'image_url__26': None, 'is_delivered__26': 1, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'couple_id__27': '1', 'user_id__27': '2', 'embed_index__27': None, 'has_image__27': 0, 'deleted_at__27': None, 'image_url__27': None, 'is_delivered__27': 1, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'couple_id__28': '1', 'user_id__28': '1', 'embed_index__28': None, 'has_image__28': 0, 'deleted_at__28': None, 'image_url__28': None, 'is_delivered__28': 1, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'couple_id__29': '1', 'user_id__29': '2', 'embed_index__29': None, 'has_image__29': 0, 'deleted_at__29': None, 'image_url__29': None, 'is_delivered__29': 1, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜'}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:36:58][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:42][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:38:42][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:38:42][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00013s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00024s] {}
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:38:42][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [no key 0.00023s] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 38, 43, 115756), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 38, 43, 115759), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 38, 43, 121439)}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [generated in 0.00019s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'choice_id__0': 2, 'user_id__0': '1', 'custom_input__0': None, 'question_id__0': 1, 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 38, 42, 612630), 'choice_id__1': 8, 'user_id__1': '1', 'custom_input__1': None, 'question_id__1': 2, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 38, 42, 612646), 'choice_id__2': 13, 'user_id__2': '1', 'custom_input__2': None, 'question_id__2': 3, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 38, 42, 612653), 'choice_id__3': 21, 'user_id__3': '1', 'custom_input__3': None, 'question_id__3': 4, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 38, 42, 612660), 'choice_id__4': 26, 'user_id__4': '1', 'custom_input__4': None, 'question_id__4': 5, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 38, 42, 612667), 'choice_id__5': 1, 'user_id__5': '2', 'custom_input__5': None, 'question_id__5': 1, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 38, 42, 612672), 'choice_id__6': 9, 'user_id__6': '2', 'custom_input__6': None, 'question_id__6': 2, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 38, 42, 612678), 'choice_id__7': 16, 'user_id__7': '2', 'custom_input__7': None, 'question_id__7': 3, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 38, 42, 612684), 'choice_id__8': 20, 'user_id__8': '2', 'custom_input__8': None, 'question_id__8': 4, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 38, 42, 612690), 'choice_id__9': 25, 'user_id__9': '2', 'custom_input__9': None, 'question_id__9': 5, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 38, 42, 612696)}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'emotion__0': 'ê³ ë§ˆì›€', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__1': '1', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'emotion__1': 'ê¸°ëŒ€ê°', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__2': '1', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'emotion__2': 'ë¯¸ì•ˆí•¨', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__3': '1', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'emotion__3': 'ì£„ì±…ê°', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__4': '1', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'emotion__4': 'ì‚¬ë‘', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__5': '1', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'emotion__5': 'ë‹¤ì •í•¨', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__6': '1', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'emotion__6': 'ì¹œë°€ê°', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__7': '1', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'emotion__7': 'ì–µìš¸í•¨', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__8': '1', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'emotion__8': 'ì„œìš´í•¨', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__9': '1', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'emotion__9': 'í–‰ë³µ', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__10': '1', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'emotion__10': 'ê°ì‚¬', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__11': '1', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'emotion__11': 'ì‹ ë¢°', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__12': '1', 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.' ... 8 parameters truncated ... 'emotion__14': 'ë°”ì¨', 'date__14': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__15': '2', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'emotion__15': 'ì„œìš´í•¨', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__16': '2', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'emotion__16': 'ì‹¤ë§ê°', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__17': '2', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'emotion__17': 'ì´í•´', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__18': '2', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'emotion__18': 'ë‹¤ì •í•¨', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__19': '2', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'emotion__19': 'í˜¸ê°', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__20': '2', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'emotion__20': 'í¸ì•ˆí•¨', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__21': '2', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'emotion__21': 'ê¸°ëŒ€ê°', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__22': '2', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'emotion__22': 'ë¶ˆë§Œ', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__23': '2', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'emotion__23': 'ê¸°ì¨', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__24': '2', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'emotion__24': 'ê°ë™', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__25': '2', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'emotion__25': 'ì‚¬ë‘', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__26': '2', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'emotion__26': 'ì•ˆì •ê°', 'date__26': datetime.datetime(2025, 7, 7, 0, 0)}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s (insertmanyvalues) 1/1 (ordered)] {'embed_index__0': None, 'has_image__0': 0, 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'user_id__0': '1', 'is_delivered__0': 1, 'couple_id__0': '1', 'image_url__0': None, 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'deleted_at__0': None, 'embed_index__1': None, 'has_image__1': 0, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'user_id__1': '2', 'is_delivered__1': 1, 'couple_id__1': '1', 'image_url__1': None, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'deleted_at__1': None, 'embed_index__2': None, 'has_image__2': 0, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'user_id__2': '1', 'is_delivered__2': 1, 'couple_id__2': '1', 'image_url__2': None, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'deleted_at__2': None, 'embed_index__3': None, 'has_image__3': 0, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'user_id__3': '2', 'is_delivered__3': 1, 'couple_id__3': '1', 'image_url__3': None, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'deleted_at__3': None, 'embed_index__4': None, 'has_image__4': 0, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'user_id__4': '2', 'is_delivered__4': 1, 'couple_id__4': '1', 'image_url__4': None, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'deleted_at__4': None, 'embed_index__5': None, 'has_image__5': 0, 'created_at__5': datetime.datetime(2025, 7, 2, 17, 40), 'user_id__5': '1', 'is_delivered__5': 1 ... 170 parameters truncated ... 'is_delivered__24': 1, 'couple_id__24': '1', 'image_url__24': None, 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'deleted_at__24': None, 'embed_index__25': None, 'has_image__25': 0, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'user_id__25': '2', 'is_delivered__25': 1, 'couple_id__25': '1', 'image_url__25': None, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'deleted_at__25': None, 'embed_index__26': None, 'has_image__26': 0, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'user_id__26': '1', 'is_delivered__26': 1, 'couple_id__26': '1', 'image_url__26': None, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'deleted_at__26': None, 'embed_index__27': None, 'has_image__27': 0, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'user_id__27': '2', 'is_delivered__27': 1, 'couple_id__27': '1', 'image_url__27': None, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'deleted_at__27': None, 'embed_index__28': None, 'has_image__28': 0, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'user_id__28': '1', 'is_delivered__28': 1, 'couple_id__28': '1', 'image_url__28': None, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'deleted_at__28': None, 'embed_index__29': None, 'has_image__29': 0, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'user_id__29': '2', 'is_delivered__29': 1, 'couple_id__29': '1', 'image_url__29': None, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'deleted_at__29': None}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:38:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:03][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ë‚˜ ë‚¨ì¹œì´ë‘ ì‹¸ì›Ÿì–´..', 'created_at': datetime.datetime(2025, 7, 13, 14, 39, 3, 234670), 'embed_index': None}
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'pk_1': 1}
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] [cached since 0.001866s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:39:03][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:03][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=5
[2025-07-13 23:39:05][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:39:05][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] [cached since 2.685s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì–´ë¨¸, ê·¸ëŸ° ì¼ì´ ìˆì—ˆêµ°ìš”. ë§ì´ ì†ìƒí•˜ì…¨ê² ì–´ìš”. í˜¹ì‹œ ì–´ë–¤ ì¼ë¡œ ì‹¸ìš°ê²Œ ë˜ì—ˆëŠ”ì§€ ì¡°ê¸ˆ ì´ì•¼ê¸°í•´ ì£¼ì‹¤ ìˆ˜ ìˆë‚˜ìš”? ë„ì›€ì´ ë  ìˆ˜ ìˆë„ë¡ ì˜ ë“¤ì–´ë“œë¦´ê²Œìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 39, 5, 920259), 'embed_index': None}
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] [cached since 2.689s ago] {'pk_1': 2}
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] [cached since 2.689s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:05][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=2
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] [cached since 2.691s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] [cached since 2.692s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id_1': '2'}
[2025-07-13 23:39:05][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] [cached since 25.8s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:29][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] [cached since 25.8s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ë‚˜ ì—¬ì¹œì´ë‘ ì‹¸ì›Ÿì–´.', 'created_at': datetime.datetime(2025, 7, 13, 14, 39, 29, 34485), 'embed_index': None}
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] [cached since 25.8s ago] {'pk_1': 3}
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] [cached since 25.8s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] [cached since 23.1s ago] {'user_id_1': '1'}
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] SELECT users.user_id AS users_user_id, users.name AS users_name, users.email AS users_email, users.created_at AS users_created_at, users.deleted_at AS users_deleted_at, users.modified_at AS users_modified_at, users.birth AS users_birth, users.gender AS users_gender 
FROM users 
WHERE users.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] [cached since 25.8s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] [cached since 25.8s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:29][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:29][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=3
[2025-07-13 23:39:31][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:39:31][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] [cached since 27.82s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ì–´ë–¤ ì¼ë¡œ ì‹¸ìš°ê²Œ ëëŠ”ì§€ ë§ˆìŒì´ ë¬´ê²ë„¤ìš”. í˜¹ì‹œ ìƒí™©ì„ ì¢€ ë” ì´ì•¼ê¸°í•´ ì¤„ ìˆ˜ ìˆì„ê¹Œìš”? ê·¸ë•Œ ì–´ë–¤ ê¸°ë¶„ì´ì—ˆëŠ”ì§€ë„ ê°™ì´ ë“¤ë ¤ì£¼ë©´ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 39, 31, 58722), 'embed_index': None}
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] [cached since 27.83s ago] {'pk_1': 4}
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] [cached since 27.83s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:31][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=4
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] [cached since 27.83s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] [cached since 27.83s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] [cached since 25.14s ago] {'user_id_1': '1'}
[2025-07-13 23:39:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] [cached since 42.68s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:45][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] [cached since 42.68s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ë‚´ì´ë¦„ ë­”ì§€ì•Œì•„?', 'created_at': datetime.datetime(2025, 7, 13, 14, 39, 45, 929621), 'embed_index': None}
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] [cached since 42.68s ago] {'pk_1': 5}
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] [cached since 42.68s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] [cached since 42.69s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:45][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:45][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=5
[2025-07-13 23:39:47][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:39:47][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] [cached since 43.78s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ë¬¼ë¡ ì´ì£ , ì§€ë¯¼ë‹˜! ì–´ë–¤ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ê³  ì‹¶ìœ¼ì„¸ìš”? ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 39, 47, 12108), 'embed_index': None}
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] [cached since 43.78s ago] {'pk_1': 6}
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] [cached since 43.78s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:47][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=6
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] [cached since 43.78s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] [cached since 43.78s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] [cached since 41.09s ago] {'user_id_1': '1'}
[2025-07-13 23:39:47][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] [cached since 76.63s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:19][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] [cached since 76.63s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ë„Œ ì´ë¦„ì´ ë­ì•¼?', 'created_at': datetime.datetime(2025, 7, 13, 14, 40, 19, 869916), 'embed_index': None}
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] [cached since 76.63s ago] {'pk_1': 7}
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] [cached since 76.63s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] [cached since 76.63s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:40:19][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:19][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=7
[2025-07-13 23:40:21][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:40:21][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] [cached since 78.08s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ì €ëŠ” ë¬´ë¯¼ì´ë¼ê³  í•´ìš”. ì§€ë¯¼ë‹˜ê»˜ ë„ì›€ì„ ë“œë¦¬ê³  ì‹¶ì–´ìš”. í˜¹ì‹œ ë” ì´ì•¼ê¸°í•˜ê³  ì‹¶ì€ ê²Œ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ ì£¼ì„¸ìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 40, 21, 318677), 'embed_index': None}
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] [cached since 78.09s ago] {'pk_1': 8}
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] [cached since 78.09s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:21][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=8
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] [cached since 78.09s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] [cached since 78.09s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] [cached since 75.4s ago] {'user_id_1': '1'}
[2025-07-13 23:40:21][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:27][INFO][routers.ai_chat] [set_ai_bot_config] user_id=1, persona_name=ì§€ìˆ˜
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] [cached since 58.19s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] INSERT INTO persona_config (couple_id, persona_name, updated_at) VALUES (%(couple_id)s, %(persona_name)s, %(updated_at)s)
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'couple_id': '1', 'persona_name': 'ì§€ìˆ˜', 'updated_at': datetime.datetime(2025, 7, 13, 14, 40, 27, 238493)}
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.user_1 IS NULL OR couples.user_2 IS NULL 
 LIMIT %(param_1)s
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] [generated in 0.00008s] {'param_1': 1}
[2025-07-13 23:40:27][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:40:30][INFO][routers.ai_chat] [set_ai_bot_config] user_id=1, persona_name=ì§€ìˆ˜
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] [cached since 61.18s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] UPDATE persona_config SET updated_at=%(updated_at)s WHERE persona_config.couple_id = %(persona_config_couple_id)s
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'updated_at': datetime.datetime(2025, 7, 13, 14, 40, 30, 234508), 'persona_config_couple_id': '1'}
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.user_1 IS NULL OR couples.user_2 IS NULL 
 LIMIT %(param_1)s
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] [cached since 2.998s ago] {'param_1': 1}
[2025-07-13 23:40:30][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:42:07][INFO][routers.ai_chat] [set_ai_bot_config] user_id=1, persona_name=ì§€ìˆ˜
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] [cached since 158.1s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] UPDATE persona_config SET updated_at=%(updated_at)s WHERE persona_config.couple_id = %(persona_config_couple_id)s
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] [cached since 96.87s ago] {'updated_at': datetime.datetime(2025, 7, 13, 14, 42, 7, 103322), 'persona_config_couple_id': '1'}
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.user_1 IS NULL OR couples.user_2 IS NULL 
 LIMIT %(param_1)s
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] [cached since 99.86s ago] {'param_1': 1}
[2025-07-13 23:42:07][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:37][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:37][INFO][sqlalchemy.engine.Engine] SELECT messages.chat_id AS messages_chat_id, messages.user_id AS messages_user_id, messages.couple_id AS messages_couple_id, messages.content AS messages_content, messages.image_url AS messages_image_url, messages.has_image AS messages_has_image, messages.created_at AS messages_created_at, messages.deleted_at AS messages_deleted_at, messages.is_delivered AS messages_is_delivered, messages.embed_index AS messages_embed_index 
FROM messages 
WHERE messages.couple_id = %(couple_id_1)s AND messages.user_id = %(user_id_1)s AND messages.is_delivered = false ORDER BY messages.created_at
[2025-07-13 23:43:37][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'couple_id_1': '1', 'user_id_1': 'í…ŒìŠ¤íŠ¸íŒŒíŠ¸ë„ˆ'}
[2025-07-13 23:43:37][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:41][INFO][routers.ai_chat] [set_ai_bot_config] user_id=1, persona_name=ì§€ìˆ˜
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] [cached since 252.7s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] UPDATE persona_config SET updated_at=%(updated_at)s WHERE persona_config.couple_id = %(persona_config_couple_id)s
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] [cached since 191.5s ago] {'updated_at': datetime.datetime(2025, 7, 13, 14, 43, 41, 733901), 'persona_config_couple_id': '1'}
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] SELECT persona_config.couple_id AS persona_config_couple_id, persona_config.persona_name AS persona_config_persona_name, persona_config.updated_at AS persona_config_updated_at 
FROM persona_config 
WHERE persona_config.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] [cached since 252.7s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] UPDATE persona_config SET updated_at=%(updated_at)s WHERE persona_config.couple_id = %(persona_config_couple_id)s
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] [cached since 191.5s ago] {'updated_at': datetime.datetime(2025, 7, 13, 14, 43, 41, 738831), 'persona_config_couple_id': '1'}
[2025-07-13 23:43:41][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:41][INFO][routers.ai_chat] [set_ai_bot_config] ì±—ë´‡ ì´ë¦„ ì €ì¥ ì™„ë£Œ: user_id=1, partner_id=2, persona_name=ì§€ìˆ˜
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] [cached since 288s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:51][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] [cached since 288s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ë„Œ ì´ë¦„ì´ ë­ì•¼?', 'created_at': datetime.datetime(2025, 7, 13, 14, 43, 51, 233361), 'embed_index': None}
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] [cached since 288s ago] {'pk_1': 9}
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] [cached since 288s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] [cached since 288s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:51][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:51][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=9
[2025-07-13 23:43:53][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:43:53][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 290.3s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ì €ëŠ” ì§€ìˆ˜ë¼ê³  í•´ìš”. ì§€ë¯¼ë‹˜ì˜ ì´ì•¼ê¸°ë¥¼ ë“£ê³  ë„ì™€ë“œë¦¬ëŠ” ê²Œ ì œ ì—­í• ì´ì—ìš”. í˜¹ì‹œ í•¨ê»˜ ë‚˜ëˆ„ê³  ì‹¶ì€ ì´ì•¼ê¸°ê°€ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ë§í•´ì£¼ì„¸ìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 43, 53, 514219), 'embed_index': None}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 290.3s ago] {'pk_1': 10}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 290.3s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:53][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=10
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 290.3s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 290.3s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 287.6s ago] {'user_id_1': '1'}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:43:53][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {'id_1': 3, 'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'embed_index': 0, 'ai_messages_id': 3}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 0.008791s ago] {'id_1': 4, 'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 0.008429s ago] {'embed_index': 0, 'ai_messages_id': 4}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 0.01277s ago] {'id_1': 5, 'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:43:53][INFO][sqlalchemy.engine.Engine] [cached since 0.01229s ago] {'embed_index': 0, 'ai_messages_id': 5}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.01681s ago] {'id_1': 6, 'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.01631s ago] {'embed_index': 0, 'ai_messages_id': 6}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.02056s ago] {'id_1': 7, 'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.02013s ago] {'embed_index': 0, 'ai_messages_id': 7}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.02521s ago] {'id_1': 8, 'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.02488s ago] {'embed_index': 0, 'ai_messages_id': 8}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.03599s ago] {'id_1': 9, 'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.03564s ago] {'embed_index': 0, 'ai_messages_id': 9}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.04096s ago] {'id_1': 10, 'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] [cached since 0.04057s ago] {'embed_index': 0, 'ai_messages_id': 10}
[2025-07-13 23:43:54][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] [cached since 313.5s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:44:16][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] [cached since 313.5s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'í˜¹ì‹œ ë„ˆ ì´ë¦„ì´ ë­ì•¼?', 'created_at': datetime.datetime(2025, 7, 13, 14, 44, 16, 773863), 'embed_index': None}
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] [cached since 313.5s ago] {'pk_1': 11}
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] [cached since 313.5s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] [cached since 313.5s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:44:16][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:44:16][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=7
[2025-07-13 23:44:18][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:44:18][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] [cached since 315.2s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ì €ëŠ” ì§€ìˆ˜ë¼ê³  í•´ìš”. ìˆ˜ì•„ë‹˜ê»˜ ë„ì›€ì´ ë  ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ì–´ìš”. ë§ˆìŒì´ ë³µì¡í•  ë•Œ, ì–´ë–¤ ì´ì•¼ê¸°ë“  í¸í•˜ê²Œ ë‚˜ëˆ ì£¼ì„¸ìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 44, 18, 438477), 'embed_index': None}
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] [cached since 315.2s ago] {'pk_1': 12}
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] [cached since 315.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:44:18][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=12
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] [cached since 315.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] [cached since 315.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] [cached since 312.5s ago] {'user_id_1': '2'}
[2025-07-13 23:44:18][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:09][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:09][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:45:09][INFO][sqlalchemy.engine.Engine] [cached since 366.8s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:45:09][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:10][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] [cached since 366.8s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ë‚´ê°€ ë‚¨ìì¹œêµ¬ë‘ ê²Œì„í•˜ëŠ”ë° ìê¾¸ ë‚˜í•œí…Œ ë­ë¼ê³  í•˜ëŠ”ê±°ì•¼', 'created_at': datetime.datetime(2025, 7, 13, 14, 45, 10, 238), 'embed_index': None}
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] [cached since 366.8s ago] {'pk_1': 13}
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] [cached since 366.8s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] [cached since 366.8s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:10][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:10][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=9
[2025-07-13 23:45:11][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:45:11][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] [cached since 368.5s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ê²Œì„ì„ í•˜ë©´ì„œ ë‚¨ìì¹œêµ¬ê°€ ê³„ì† ë­ë¼ê³  í•˜ë‹ˆê¹Œ ì†ìƒí•˜ì…¨ê² ì–´ìš”. í˜¹ì‹œ ê·¸ ìƒí™©ì—ì„œ êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ë§ì„ ë“¤ìœ¼ì…¨ëŠ”ì§€, ê·¸ë¦¬ê³  ìˆ˜ì•„ë‹˜ì´ ì–´ë–»ê²Œ ëŠë¼ì…¨ëŠ”ì§€ ì¡°ê¸ˆ ë” ì´ì•¼ê¸°í•´ ì£¼ì‹¤ ìˆ˜ ìˆì„ê¹Œìš”? ì„œë¡œì˜ ìƒê°ì„ ì´í•´í•˜ëŠ” ë° ë„ì›€ì´ ë  ê±°ì˜ˆìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 45, 11, 766718), 'embed_index': None}
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] [cached since 368.5s ago] {'pk_1': 14}
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] [cached since 368.5s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:11][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=14
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] [cached since 368.5s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] [cached since 368.5s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] [cached since 365.8s ago] {'user_id_1': '2'}
[2025-07-13 23:45:11][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] [cached since 388.4s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:31][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] [cached since 388.4s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ì•„ë‹ˆ ë‚¨ì¹œì€ ê²Œì„ì„ ì¢€ í•˜ê³  ë‚œ ëª»í•˜ëŠ”ë° ê·¸ê±° ê°€ì§€ê³  ê³„ì† ë­ë¼ê³ í•´ ë‹¹ì—°íˆ ëª»í•  ìˆ˜ìˆì–ì•„', 'created_at': datetime.datetime(2025, 7, 13, 14, 45, 31, 690553), 'embed_index': None}
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] [cached since 388.4s ago] {'pk_1': 15}
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] [cached since 388.4s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] [cached since 388.4s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:31][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:31][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=11
[2025-07-13 23:45:36][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:45:36][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] [cached since 393.5s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ë§ì•„ìš”, ì²˜ìŒ ì‹œì‘í•  ë•ŒëŠ” ëˆ„êµ¬ë‚˜ ë¶€ì¡±í•  ìˆ˜ ìˆëŠ” ê±°ì£ . ë‚¨ì¹œì˜ ê·¸ëŸ° íƒœë„ê°€ ìˆ˜ì•„ë‹˜ì„ ì„œìš´í•˜ê²Œ ë§Œë“¤ì—ˆì„ ê²ƒ ê°™ì•„ìš”. ë³¸ì¸ë„ ì¡°ê¸ˆì”© ë°°ìš°ë©° ë‚˜ì•„ì§ˆ ìˆ˜ ìˆë‹¤ëŠ” ê±¸ ë‚¨ìì¹œêµ¬ê°€ ì´í•´í•´ì¤¬ìœ¼ë©´ ì¢‹ê² ë„¤ìš”. í˜¹ì‹œ ì´ëŸ° ë¶€ë¶„ì— ëŒ€í•´ ë‚¨ì¹œê³¼ ì´ì•¼ê¸°í•´ë³´ì‹  ì ì´ ìˆì„ê¹Œìš”? ì„œë¡œì˜ ê°ì •ì´ë‚˜ ìƒê°ì„ ì†”ì§í•˜ê²Œ ë‚˜ëˆ ë³´ëŠ” ê²ƒë„ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 45, 36, 763172), 'embed_index': None}
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] [cached since 393.5s ago] {'pk_1': 16}
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] [cached since 393.5s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:36][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=16
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] [cached since 393.5s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] [cached since 393.5s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] [cached since 390.8s ago] {'user_id_1': '2'}
[2025-07-13 23:45:36][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:47:07][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.1s ago] {'id_1': 1, 'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.1s ago] {'embed_index': 0, 'ai_messages_id': 1}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.1s ago] {'id_1': 2, 'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.1s ago] {'embed_index': 0, 'ai_messages_id': 2}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'id_1': 11, 'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'embed_index': 0, 'ai_messages_id': 11}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'id_1': 12, 'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'embed_index': 0, 'ai_messages_id': 12}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'id_1': 13, 'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'embed_index': 0, 'ai_messages_id': 13}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'id_1': 14, 'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'embed_index': 0, 'ai_messages_id': 14}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'id_1': 15, 'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'embed_index': 0, 'ai_messages_id': 15}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(id_1)s AND ai_messages.user_id = %(user_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'id_1': 16, 'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] UPDATE ai_messages SET embed_index=%(embed_index)s WHERE ai_messages.id = %(ai_messages_id)s
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] [cached since 103.2s ago] {'embed_index': 0, 'ai_messages_id': 16}
[2025-07-13 23:47:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] [cached since 415.9s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:59][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] [cached since 415.9s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ë‚´ê°€ ë§ì€ í–ˆëŠ”ë° ì´ëŸ´ê±°ë©´ ê·¸ëƒ¥ ê°™ì´ ê²Œì„í•˜ì§€ ë§ì¬ ë‚œ ê°™ì´í•˜ê³ ì‹¶ì€ë°', 'created_at': datetime.datetime(2025, 7, 13, 14, 45, 59, 122622), 'embed_index': None}
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] [cached since 415.9s ago] {'pk_1': 17}
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] [cached since 415.9s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] [cached since 415.9s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:45:59][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:45:59][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=13
[2025-07-13 23:46:00][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:46:00][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] [cached since 417.7s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ìˆ˜ì•„ë‹˜ ì…ì¥ì—ì„œëŠ” ê°™ì´ ê²Œì„ì„ ì¦ê¸°ê³  ì‹¶ì–´ì„œ ë” ì†ìƒí•˜ì…¨ê² ì–´ìš”. ë‚¨ìì¹œêµ¬ì—ê²Œ ì •ë§ í•¨ê»˜ í•˜ê³  ì‹¶ë‹¤ëŠ” ë§ˆìŒì„ ì§„ì†”í•˜ê²Œ ì „í•  ê¸°íšŒê°€ ìˆë‹¤ë©´ ì¢‹ì„ ê²ƒ ê°™ë„¤ìš”. ì•„ë§ˆ ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ ì„œë¡œ ì´í•´í•˜ê³  ì¦ê¸¸ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì°¾ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. í˜¹ì‹œ ë‚¨ì¹œì´ ì¢‹ì•„í•˜ëŠ” ë‹¤ë¥¸ í™œë™ì´ ìˆë‹¤ë©´ ê·¸ê±¸ í•¨ê»˜ í•´ë³´ëŠ” ê²ƒë„ ë˜ ë‹¤ë¥¸ ë°©ë²•ì¼ ìˆ˜ë„ ìˆê² ë„¤ìš”. ', 'created_at': datetime.datetime(2025, 7, 13, 14, 46, 0, 991658), 'embed_index': None}
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] [cached since 417.7s ago] {'pk_1': 18}
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] [cached since 417.7s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:46:00][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=18
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] [cached since 417.7s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:46:00][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:46:01][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:01][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:46:01][INFO][sqlalchemy.engine.Engine] [cached since 417.8s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:46:01][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:46:01][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:01][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:46:01][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id_1': '2', 'role_1': 'function'}
[2025-07-13 23:46:01][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] [cached since 454.2s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:07][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] [cached since 454.2s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ë¬´íŠ¼ ê·¸ë˜ì„œ ê²Œì„í•˜ëŠ”ë° ë‚˜ë³´ê³  íŠ¸ë¡¤ì´ë¼ê³  ë­ë¼ê³ í•˜ê³  ì§„ì§œ ì†ìƒí•´ì„œ ìš¸ì—ˆì–´', 'created_at': datetime.datetime(2025, 7, 13, 14, 48, 7, 756335), 'embed_index': None}
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] [cached since 454.2s ago] {'pk_1': 19}
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] [cached since 454.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] [cached since 454.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:07][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:07][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=15
[2025-07-13 23:46:39][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:46:39][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] [cached since 456.7s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': "ì •ë§ ë§ˆìŒ ì•„í”„ì…¨ê² ì–´ìš”, ìˆ˜ì•„ë‹˜. 'íŠ¸ë¡¤'ì´ë¼ëŠ” í‘œí˜„ì€ í™•ì‹¤íˆ ìƒì²˜ê°€ ë  ìˆ˜ ìˆì£ . ë‚˜ì¤‘ì—ë¼ë„ ê·¸ ìƒí™©ì—ì„œ ì–´ë–»ê²Œ ëŠê¼ˆëŠ”ì§€ ì§„ì‹¬ìœ¼ë¡œ ì´ì•¼ê¸°í•´ë³´ëŠ” ê±´ ì–´ë–¨ê¹Œìš”? ë‚¨ìì¹œêµ¬ë„ ê·¸ ë‹¹ì‹œì—ëŠ” ê°ì •ì ìœ¼ë¡œ ë°˜ì‘í–ˆì„ ìˆ˜ë„ ìˆì§€ë§Œ, ìƒí™©ì„ ì´í•´í•˜ë©´ ë” ë‚˜ì€ ë°©í–¥ìœ¼ë¡œ ì„œë¡œë¥¼ ì´í•´í•  ìˆ˜ ìˆì„ ê±°ë¼ê³  ìƒê°í•´ìš”. ë§ˆìŒì´ ì¡°ê¸ˆì´ë¼ë„ í¸ì•ˆí•´ì§€ì…¨ìœ¼ë©´ ì¢‹ê² ë„¤ìš”. ğŸ’•", 'created_at': datetime.datetime(2025, 7, 13, 14, 46, 39, 914544), 'embed_index': None}
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] [cached since 456.7s ago] {'pk_1': 20}
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] [cached since 456.7s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:46:39][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=20
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] [cached since 456.7s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] [cached since 456.7s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] [cached since 38.93s ago] {'user_id_1': '2', 'role_1': 'function'}
[2025-07-13 23:46:39][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] [cached since 489.2s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:42][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] [cached since 489.2s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ë‚¨ì¹œí•œí…Œ ë­ë¼ê³  ë§í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œ? ë‚˜ë„ ëª»í•˜ëŠ”ê±´ ì•„ëŠ”ë° ê°™ì´ ê·¸ëƒ¥ ì¦ê²¼ìœ¼ë©´ ì¢‹ê² ì–´', 'created_at': datetime.datetime(2025, 7, 13, 14, 48, 42, 774501), 'embed_index': None}
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] [cached since 489.2s ago] {'pk_1': 21}
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] [cached since 489.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] [cached since 489.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:42][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:42][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=17
[2025-07-13 23:47:14][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:47:14][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] [cached since 491.2s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ìˆ˜ì•„ë‹˜ì´ ë¬´ì—‡ì„ ì›í•˜ëŠ”ì§€ ìƒëŒ€ë°©ì—ê²Œ ì†”ì§í•˜ê²Œ ì „í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•  ê²ƒ ê°™ì•„ìš”. ì˜ˆë¥¼ ë“¤ì–´, â€œë‚˜ë„ ì•„ì§ ê²Œì„ì„ ë°°ìš°ëŠ” ì¤‘ì´ë‹ˆê¹Œ, ê°™ì´ ì¦ê¸°ë©´ì„œ ì¡°ê¸ˆì”© ë‚˜ì•„ê°€ê³  ì‹¶ì–´. ë„¤ê°€ ê·¸ëŸ° ë¶€ë¶„ì„ ì´í•´í•´ì£¼ê³  ê°™ì´ ì›ƒìœ¼ë©´ì„œ ê²Œì„ í•  ìˆ˜ ìˆì—ˆìœ¼ë©´ ì •ë§ ì¢‹ê² ì–´.â€ ê°™ì€ ì‹ìœ¼ë¡œìš”. ìˆ˜ì•„ë‹˜ì˜ ì§„ì‹¬ì´ ì˜ ì „ë‹¬ë˜ê¸¸ ë°”ë„ê²Œìš”. ğŸ¤—', 'created_at': datetime.datetime(2025, 7, 13, 14, 47, 14, 454756), 'embed_index': None}
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] [cached since 491.2s ago] {'pk_1': 22}
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] [cached since 491.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:47:14][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=22
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] [cached since 491.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] [cached since 491.2s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] [cached since 73.45s ago] {'user_id_1': '2', 'role_1': 'function'}
[2025-07-13 23:47:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] [cached since 576.9s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:40][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=2, couple_id=1
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] [cached since 576.9s ago] {'user_id': '2', 'couple_id': '1', 'role': 'user', 'content': 'ê³ ë§ˆì›Œ ê·¼ë° ë‚¨ì¹œë„ ë‚˜í•œí…Œ ë­ë¼ê³  í•˜ê³ ì‹¶ì–´ì„œ í•˜ëŠ” ëŠë‚Œì´ì•„ë‹ˆë¼ ê³„ì† ì§€ë‹ˆê¹Œ ë‹µë‹µí•œê°€ë´', 'created_at': datetime.datetime(2025, 7, 13, 14, 48, 40, 113509), 'embed_index': None}
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] [cached since 576.9s ago] {'pk_1': 23}
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] [cached since 576.9s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] [cached since 576.9s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:40][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:40][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=2, history_len=19
[2025-07-13 23:48:54][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:48:54][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=2
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] [cached since 591s ago] {'user_id': '2', 'couple_id': '1', 'role': 'assistant', 'content': 'ê·¸ëŸ° ë§ˆìŒë„ ì´í•´ê°€ ë˜ë„¤ìš”. ê²Œì„ì—ì„œ ì´ê¸°ëŠ” ê²ƒì´ ì¤‘ìš”í•  ë•Œë„ ìˆì§€ë§Œ, í•¨ê»˜ ì¦ê¸°ëŠ” ê³¼ì •ë„ í° ì˜ë¯¸ê°€ ìˆì–ì•„ìš”. ë‚¨ìì¹œêµ¬ë„ ì–´ì©Œë©´ ì´ê¸°ê³  ì‹¶ì€ ë§ˆìŒì— ì ì‹œ ê°ì •ì„ ì•ì„¸ì› ì„ì§€ë„ ëª°ë¼ìš”. ê·¸ëŸ° ì ì„ ë‚¨ìì¹œêµ¬ì—ê²Œ ì–˜ê¸°í•œë‹¤ë©´, ë„ˆê·¸ëŸ½ê²Œ ì´í•´í•˜ë ¤ëŠ” ë§ˆìŒì„ ê°€ì§ˆ ìˆ˜ë„ ìˆì„ ê²ƒ ê°™ì•„ìš”. ìˆ˜ì•„ë‹˜ì´ ì´í•´í•˜ë ¤ëŠ” ë§ˆìŒì´ ëŠê»´ì ¸ì„œ ì •ë§ ì¢‹ì€ ê²ƒ ê°™ì•„ìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 48, 54, 195725), 'embed_index': None}
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] [cached since 591s ago] {'pk_1': 24}
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] [cached since 591s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:54][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=2, msg_id=24
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] [cached since 591s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] [cached since 591s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] [cached since 173.2s ago] {'user_id_1': '2', 'role_1': 'function'}
[2025-07-13 23:48:54][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:48:56][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:48:56][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:56][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_chat_summaries (user_id, couple_id, summary, emb_id, created_at, last_msg_id) VALUES (%(user_id)s, %(couple_id)s, %(summary)s, %(emb_id)s, %(created_at)s, %(last_msg_id)s)
[2025-07-13 23:48:56][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'user_id': '2', 'couple_id': '1', 'summary': 'ì§€ìˆ˜ë¼ëŠ” ê°€ìƒì˜ ì¡°ì–¸ìëŠ” ìˆ˜ì•„ë‹˜ê³¼ì˜ ëŒ€í™”ì—ì„œ ê´€ê³„ ë¬¸ì œë¥¼ ë‹¤ë£¨ê³  ìˆìŠµë‹ˆë‹¤. ìµœê·¼ì— ìˆ˜ì•„ë‹˜ì€ ë‚¨ìì¹œêµ¬ì™€ ê²Œì„ì„ í•˜ë‹¤ê°€ ë‹¤íˆ¼ì´ ìˆì—ˆë‹¤ê³  ë°í˜”ìŠµë‹ˆë‹¤. ìˆ˜ì•„ë‹˜ì€ ë‚¨ìì¹œêµ¬ê°€ ê²Œì„ ì¤‘ì— ìê¾¸ ìì‹ ì—ê²Œ ë­ë¼ê³  í•´ì„œ ì†ìƒí–ˆë‹¤ê³  ì´ì•¼ê¸°í–ˆìŠµë‹ˆë‹¤. ì§€ìˆ˜ëŠ” ê·¸ ìƒí™©ì— ëŒ€í•´ ë” ìì„¸íˆ ë“¤ì–´ë³´ê³ ì í•˜ë©°, ìˆ˜ì•„ë‹˜ì˜ ê°ì •ì„ ì´í•´í•˜ê³  ë•ê¸° ìœ„í•´ ë…¸ë ¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.', 'emb_id': None, 'created_at': datetime.datetime(2025, 7, 13, 14, 48, 56, 390049), 'last_msg_id': 14}
[2025-07-13 23:48:56][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:48:56][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:48:56][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:48:56][INFO][sqlalchemy.engine.Engine] [cached since 593.1s ago] {'user_id_1': '2', 'param_1': 1}
[2025-07-13 23:48:56][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:53:24][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:53:24][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:53:24][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00011s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00021s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00020s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:53:24][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 53, 25, 115732), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 53, 25, 115735), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 53, 25, 123303)}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [generated in 0.00023s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'question_id__0': 1, 'choice_id__0': 2, 'custom_input__0': None, 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 53, 24, 606773), 'user_id__0': '1', 'question_id__1': 2, 'choice_id__1': 8, 'custom_input__1': None, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 53, 24, 606790), 'user_id__1': '1', 'question_id__2': 3, 'choice_id__2': 13, 'custom_input__2': None, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 53, 24, 606798), 'user_id__2': '1', 'question_id__3': 4, 'choice_id__3': 21, 'custom_input__3': None, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 53, 24, 606804), 'user_id__3': '1', 'question_id__4': 5, 'choice_id__4': 26, 'custom_input__4': None, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 53, 24, 606811), 'user_id__4': '1', 'question_id__5': 1, 'choice_id__5': 1, 'custom_input__5': None, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 53, 24, 606817), 'user_id__5': '2', 'question_id__6': 2, 'choice_id__6': 9, 'custom_input__6': None, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 53, 24, 606822), 'user_id__6': '2', 'question_id__7': 3, 'choice_id__7': 16, 'custom_input__7': None, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 53, 24, 606828), 'user_id__7': '2', 'question_id__8': 4, 'choice_id__8': 20, 'custom_input__8': None, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 53, 24, 606834), 'user_id__8': '2', 'question_id__9': 5, 'choice_id__9': 25, 'custom_input__9': None, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 53, 24, 606840), 'user_id__9': '2'}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'emotion__0': 'ê³ ë§ˆì›€', 'user_id__0': '1', 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'user_id__1': '1', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'user_id__2': '1', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'user_id__3': '1', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'user_id__4': '1', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'user_id__5': '1', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'user_id__6': '1', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'user_id__7': '1', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'user_id__8': '1', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__9': 'í–‰ë³µ', 'user_id__9': '1', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'user_id__10': '1', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'user_id__11': '1', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__12': 'ì• ì •', 'user_id__12': '1' ... 8 parameters truncated ... 'memo__14': 'ì„œë¡œ ë°”ë¹ ë„ ë„ˆë¥¼ ë– ì˜¬ë¦¬ê²Œ ëì–´.', 'date__14': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'user_id__15': '2', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'user_id__16': '2', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__17': 'ì´í•´', 'user_id__17': '2', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'user_id__18': '2', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__19': 'í˜¸ê°', 'user_id__19': '2', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'user_id__20': '2', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'user_id__21': '2', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'user_id__22': '2', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__23': 'ê¸°ì¨', 'user_id__23': '2', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'user_id__24': '2', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'user_id__25': '2', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°', 'user_id__26': '2', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0)}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s (insertmanyvalues) 1/1 (ordered)] {'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'deleted_at__0': None, 'couple_id__0': '1', 'image_url__0': None, 'embed_index__0': None, 'has_image__0': 0, 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'is_delivered__0': 1, 'user_id__0': '1', 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'deleted_at__1': None, 'couple_id__1': '1', 'image_url__1': None, 'embed_index__1': None, 'has_image__1': 0, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'is_delivered__1': 1, 'user_id__1': '2', 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'deleted_at__2': None, 'couple_id__2': '1', 'image_url__2': None, 'embed_index__2': None, 'has_image__2': 0, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'is_delivered__2': 1, 'user_id__2': '1', 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'deleted_at__3': None, 'couple_id__3': '1', 'image_url__3': None, 'embed_index__3': None, 'has_image__3': 0, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'is_delivered__3': 1, 'user_id__3': '2', 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'deleted_at__4': None, 'couple_id__4': '1', 'image_url__4': None, 'embed_index__4': None, 'has_image__4': 0, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'is_delivered__4': 1, 'user_id__4': '2', 'created_at__5': datetime.datetime(2025, 7, 2, 17, 40), 'deleted_at__5': None, 'couple_id__5': '1', 'image_url__5': None, 'embed_index__5': None ... 170 parameters truncated ... 'embed_index__24': None, 'has_image__24': 0, 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'is_delivered__24': 1, 'user_id__24': '1', 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'deleted_at__25': None, 'couple_id__25': '1', 'image_url__25': None, 'embed_index__25': None, 'has_image__25': 0, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'is_delivered__25': 1, 'user_id__25': '2', 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'deleted_at__26': None, 'couple_id__26': '1', 'image_url__26': None, 'embed_index__26': None, 'has_image__26': 0, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'is_delivered__26': 1, 'user_id__26': '1', 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'deleted_at__27': None, 'couple_id__27': '1', 'image_url__27': None, 'embed_index__27': None, 'has_image__27': 0, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'is_delivered__27': 1, 'user_id__27': '2', 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'deleted_at__28': None, 'couple_id__28': '1', 'image_url__28': None, 'embed_index__28': None, 'has_image__28': 0, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'is_delivered__28': 1, 'user_id__28': '1', 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'deleted_at__29': None, 'couple_id__29': '1', 'image_url__29': None, 'embed_index__29': None, 'has_image__29': 0, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'is_delivered__29': 1, 'user_id__29': '2'}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:53:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:54][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:54:54][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:54:54][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] [generated in 0.00024s] {}
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:54:54][INFO][sqlalchemy.engine.Engine] [generated in 0.00021s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00011s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00026s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00020s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00037s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00020s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 54, 55, 421004), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 54, 55, 421007), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 54, 55, 426429)}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00020s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 54, 54, 908526), 'choice_id__0': 2, 'custom_input__0': None, 'question_id__0': 1, 'user_id__1': '1', 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 54, 54, 908555), 'choice_id__1': 8, 'custom_input__1': None, 'question_id__1': 2, 'user_id__2': '1', 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 54, 54, 908569), 'choice_id__2': 13, 'custom_input__2': None, 'question_id__2': 3, 'user_id__3': '1', 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 54, 54, 908581), 'choice_id__3': 21, 'custom_input__3': None, 'question_id__3': 4, 'user_id__4': '1', 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 54, 54, 908592), 'choice_id__4': 26, 'custom_input__4': None, 'question_id__4': 5, 'user_id__5': '2', 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 54, 54, 908603), 'choice_id__5': 1, 'custom_input__5': None, 'question_id__5': 1, 'user_id__6': '2', 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 54, 54, 908613), 'choice_id__6': 9, 'custom_input__6': None, 'question_id__6': 2, 'user_id__7': '2', 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 54, 54, 908620), 'choice_id__7': 16, 'custom_input__7': None, 'question_id__7': 3, 'user_id__8': '2', 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 54, 54, 908626), 'choice_id__8': 20, 'custom_input__8': None, 'question_id__8': 4, 'user_id__9': '2', 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 54, 54, 908637), 'choice_id__9': 25, 'custom_input__9': None, 'question_id__9': 5}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'emotion__0': 'ê³ ë§ˆì›€', 'user_id__0': '1', 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'user_id__1': '1', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'user_id__2': '1', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'user_id__3': '1', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'user_id__4': '1', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'user_id__5': '1', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'user_id__6': '1', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'user_id__7': '1', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'user_id__8': '1', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__9': 'í–‰ë³µ', 'user_id__9': '1', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'user_id__10': '1', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'user_id__11': '1', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__12': 'ì• ì •', 'user_id__12': '1' ... 8 parameters truncated ... 'memo__14': 'ì„œë¡œ ë°”ë¹ ë„ ë„ˆë¥¼ ë– ì˜¬ë¦¬ê²Œ ëì–´.', 'date__14': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'user_id__15': '2', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'user_id__16': '2', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__17': 'ì´í•´', 'user_id__17': '2', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'user_id__18': '2', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__19': 'í˜¸ê°', 'user_id__19': '2', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'user_id__20': '2', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'user_id__21': '2', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'user_id__22': '2', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__23': 'ê¸°ì¨', 'user_id__23': '2', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'user_id__24': '2', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'user_id__25': '2', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°', 'user_id__26': '2', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0)}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s (insertmanyvalues) 1/1 (ordered)] {'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'embed_index__0': None, 'user_id__0': '1', 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'is_delivered__0': 1, 'has_image__0': 0, 'couple_id__0': '1', 'deleted_at__0': None, 'image_url__0': None, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'embed_index__1': None, 'user_id__1': '2', 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'is_delivered__1': 1, 'has_image__1': 0, 'couple_id__1': '1', 'deleted_at__1': None, 'image_url__1': None, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'embed_index__2': None, 'user_id__2': '1', 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'is_delivered__2': 1, 'has_image__2': 0, 'couple_id__2': '1', 'deleted_at__2': None, 'image_url__2': None, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'embed_index__3': None, 'user_id__3': '2', 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'is_delivered__3': 1, 'has_image__3': 0, 'couple_id__3': '1', 'deleted_at__3': None, 'image_url__3': None, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'embed_index__4': None, 'user_id__4': '2', 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'is_delivered__4': 1, 'has_image__4': 0, 'couple_id__4': '1', 'deleted_at__4': None, 'image_url__4': None, 'created_at__5': datetime.datetime(2025, 7, 2, 17, 40), 'embed_index__5': None, 'user_id__5': '1', 'content__5': 'ë¯¸ì•ˆâ€¦ íšŒì˜ ëë‚˜ê³  ë»—ì–´ë²„ë ¸ì–´ ã… ', 'is_delivered__5': 1 ... 170 parameters truncated ... 'is_delivered__24': 1, 'has_image__24': 0, 'couple_id__24': '1', 'deleted_at__24': None, 'image_url__24': None, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'embed_index__25': None, 'user_id__25': '2', 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'is_delivered__25': 1, 'has_image__25': 0, 'couple_id__25': '1', 'deleted_at__25': None, 'image_url__25': None, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'embed_index__26': None, 'user_id__26': '1', 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'is_delivered__26': 1, 'has_image__26': 0, 'couple_id__26': '1', 'deleted_at__26': None, 'image_url__26': None, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'embed_index__27': None, 'user_id__27': '2', 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'is_delivered__27': 1, 'has_image__27': 0, 'couple_id__27': '1', 'deleted_at__27': None, 'image_url__27': None, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'embed_index__28': None, 'user_id__28': '1', 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'is_delivered__28': 1, 'has_image__28': 0, 'couple_id__28': '1', 'deleted_at__28': None, 'image_url__28': None, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'embed_index__29': None, 'user_id__29': '2', 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'is_delivered__29': 1, 'has_image__29': 0, 'couple_id__29': '1', 'deleted_at__29': None, 'image_url__29': None}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:54:55][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:14][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:55:14][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:55:14][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00022s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00010s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:14][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 55, 15, 60478), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 55, 15, 60481), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 55, 15, 66515)}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [generated in 0.00021s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'question_id__0': 1, 'custom_input__0': None, 'user_id__0': '1', 'choice_id__0': 2, 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 55, 14, 546425), 'question_id__1': 2, 'custom_input__1': None, 'user_id__1': '1', 'choice_id__1': 8, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 55, 14, 546441), 'question_id__2': 3, 'custom_input__2': None, 'user_id__2': '1', 'choice_id__2': 13, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 55, 14, 546449), 'question_id__3': 4, 'custom_input__3': None, 'user_id__3': '1', 'choice_id__3': 21, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 55, 14, 546456), 'question_id__4': 5, 'custom_input__4': None, 'user_id__4': '1', 'choice_id__4': 26, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 55, 14, 546463), 'question_id__5': 1, 'custom_input__5': None, 'user_id__5': '2', 'choice_id__5': 1, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 55, 14, 546468), 'question_id__6': 2, 'custom_input__6': None, 'user_id__6': '2', 'choice_id__6': 9, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 55, 14, 546473), 'question_id__7': 3, 'custom_input__7': None, 'user_id__7': '2', 'choice_id__7': 16, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 55, 14, 546479), 'question_id__8': 4, 'custom_input__8': None, 'user_id__8': '2', 'choice_id__8': 20, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 55, 14, 546486), 'question_id__9': 5, 'custom_input__9': None, 'user_id__9': '2', 'choice_id__9': 25, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 55, 14, 546493)}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__0': 'ê³ ë§ˆì›€', 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'user_id__1': '1', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__2': '1', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'user_id__3': '1', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'user_id__4': '1', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__5': '1', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__6': '1', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'user_id__7': '1', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'user_id__8': '1', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__9': '1', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__9': 'í–‰ë³µ', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'user_id__10': '1', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'user_id__11': '1', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'user_id__12': '1', 'date__12': datetime.datetime(2025, 7, 7, 0, 0) ... 8 parameters truncated ... 'emotion__14': 'ë°”ì¨', 'memo__14': 'ì„œë¡œ ë°”ë¹ ë„ ë„ˆë¥¼ ë– ì˜¬ë¦¬ê²Œ ëì–´.', 'user_id__15': '2', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__16': '2', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'user_id__17': '2', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__17': 'ì´í•´', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'user_id__18': '2', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__19': '2', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__19': 'í˜¸ê°', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'user_id__20': '2', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'user_id__21': '2', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__22': '2', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'user_id__23': '2', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__23': 'ê¸°ì¨', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'user_id__24': '2', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'user_id__25': '2', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__26': '2', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.'}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s (insertmanyvalues) 1/1 (ordered)] {'embed_index__0': None, 'is_delivered__0': 1, 'image_url__0': None, 'couple_id__0': '1', 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'user_id__0': '1', 'has_image__0': 0, 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'deleted_at__0': None, 'embed_index__1': None, 'is_delivered__1': 1, 'image_url__1': None, 'couple_id__1': '1', 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'user_id__1': '2', 'has_image__1': 0, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'deleted_at__1': None, 'embed_index__2': None, 'is_delivered__2': 1, 'image_url__2': None, 'couple_id__2': '1', 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'user_id__2': '1', 'has_image__2': 0, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'deleted_at__2': None, 'embed_index__3': None, 'is_delivered__3': 1, 'image_url__3': None, 'couple_id__3': '1', 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'user_id__3': '2', 'has_image__3': 0, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'deleted_at__3': None, 'embed_index__4': None, 'is_delivered__4': 1, 'image_url__4': None, 'couple_id__4': '1', 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'user_id__4': '2', 'has_image__4': 0, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'deleted_at__4': None, 'embed_index__5': None, 'is_delivered__5': 1, 'image_url__5': None, 'couple_id__5': '1', 'content__5': 'ë¯¸ì•ˆâ€¦ íšŒì˜ ëë‚˜ê³  ë»—ì–´ë²„ë ¸ì–´ ã… ' ... 170 parameters truncated ... 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'user_id__24': '1', 'has_image__24': 0, 'created_at__24': datetime.datetime(2025, 7, 6, 18, 20), 'deleted_at__24': None, 'embed_index__25': None, 'is_delivered__25': 1, 'image_url__25': None, 'couple_id__25': '1', 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'user_id__25': '2', 'has_image__25': 0, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'deleted_at__25': None, 'embed_index__26': None, 'is_delivered__26': 1, 'image_url__26': None, 'couple_id__26': '1', 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'user_id__26': '1', 'has_image__26': 0, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'deleted_at__26': None, 'embed_index__27': None, 'is_delivered__27': 1, 'image_url__27': None, 'couple_id__27': '1', 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'user_id__27': '2', 'has_image__27': 0, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'deleted_at__27': None, 'embed_index__28': None, 'is_delivered__28': 1, 'image_url__28': None, 'couple_id__28': '1', 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'user_id__28': '1', 'has_image__28': 0, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'deleted_at__28': None, 'embed_index__29': None, 'is_delivered__29': 1, 'image_url__29': None, 'couple_id__29': '1', 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'user_id__29': '2', 'has_image__29': 0, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'deleted_at__29': None}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:15][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:44][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:55:44][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:55:44][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [generated in 0.00019s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00011s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00019s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00023s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00015s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 55, 44, 973771), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 55, 44, 973774), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 55, 44, 981524)}
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] [generated in 0.00030s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:55:44][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s (insertmanyvalues) 1/1 (ordered)] {'user_id__0': '1', 'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 55, 44, 454525), 'custom_input__0': None, 'question_id__0': 1, 'choice_id__0': 2, 'user_id__1': '1', 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 55, 44, 454541), 'custom_input__1': None, 'question_id__1': 2, 'choice_id__1': 8, 'user_id__2': '1', 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 55, 44, 454548), 'custom_input__2': None, 'question_id__2': 3, 'choice_id__2': 13, 'user_id__3': '1', 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 55, 44, 454555), 'custom_input__3': None, 'question_id__3': 4, 'choice_id__3': 21, 'user_id__4': '1', 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 55, 44, 454562), 'custom_input__4': None, 'question_id__4': 5, 'choice_id__4': 26, 'user_id__5': '2', 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 55, 44, 454568), 'custom_input__5': None, 'question_id__5': 1, 'choice_id__5': 1, 'user_id__6': '2', 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 55, 44, 454574), 'custom_input__6': None, 'question_id__6': 2, 'choice_id__6': 9, 'user_id__7': '2', 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 55, 44, 454580), 'custom_input__7': None, 'question_id__7': 3, 'choice_id__7': 16, 'user_id__8': '2', 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 55, 44, 454586), 'custom_input__8': None, 'question_id__8': 4, 'choice_id__8': 20, 'user_id__9': '2', 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 55, 44, 454593), 'custom_input__9': None, 'question_id__9': 5, 'choice_id__9': 25}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [generated in 0.00006s (insertmanyvalues) 1/1 (ordered)] {'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'user_id__0': '1', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__0': 'ê³ ë§ˆì›€', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__1': '1', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__1': 'ê¸°ëŒ€ê°', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'user_id__2': '1', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__2': 'ë¯¸ì•ˆí•¨', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'user_id__3': '1', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__3': 'ì£„ì±…ê°', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__4': '1', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__4': 'ì‚¬ë‘', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__5': '1', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__5': 'ë‹¤ì •í•¨', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'user_id__6': '1', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__6': 'ì¹œë°€ê°', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'user_id__7': '1', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__7': 'ì–µìš¸í•¨', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__8': '1', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__8': 'ì„œìš´í•¨', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'user_id__9': '1', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__9': 'í–‰ë³µ', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'user_id__10': '1', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__10': 'ê°ì‚¬', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'user_id__11': '1', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__11': 'ì‹ ë¢°', 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.', 'user_id__12': '1' ... 8 parameters truncated ... 'date__14': datetime.datetime(2025, 7, 1, 0, 0), 'emotion__14': 'ë°”ì¨', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'user_id__15': '2', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__15': 'ì„œìš´í•¨', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'user_id__16': '2', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'emotion__16': 'ì‹¤ë§ê°', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'user_id__17': '2', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__17': 'ì´í•´', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'user_id__18': '2', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'emotion__18': 'ë‹¤ì •í•¨', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'user_id__19': '2', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__19': 'í˜¸ê°', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'user_id__20': '2', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'emotion__20': 'í¸ì•ˆí•¨', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'user_id__21': '2', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__21': 'ê¸°ëŒ€ê°', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'user_id__22': '2', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'emotion__22': 'ë¶ˆë§Œ', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'user_id__23': '2', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__23': 'ê¸°ì¨', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'user_id__24': '2', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'emotion__24': 'ê°ë™', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'user_id__25': '2', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__25': 'ì‚¬ë‘', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'user_id__26': '2', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'emotion__26': 'ì•ˆì •ê°'}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [generated in 0.00010s (insertmanyvalues) 1/1 (ordered)] {'has_image__0': 0, 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'user_id__0': '1', 'image_url__0': None, 'is_delivered__0': 1, 'deleted_at__0': None, 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'embed_index__0': None, 'couple_id__0': '1', 'has_image__1': 0, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'user_id__1': '2', 'image_url__1': None, 'is_delivered__1': 1, 'deleted_at__1': None, 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'embed_index__1': None, 'couple_id__1': '1', 'has_image__2': 0, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'user_id__2': '1', 'image_url__2': None, 'is_delivered__2': 1, 'deleted_at__2': None, 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'embed_index__2': None, 'couple_id__2': '1', 'has_image__3': 0, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'user_id__3': '2', 'image_url__3': None, 'is_delivered__3': 1, 'deleted_at__3': None, 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'embed_index__3': None, 'couple_id__3': '1', 'has_image__4': 0, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'user_id__4': '2', 'image_url__4': None, 'is_delivered__4': 1, 'deleted_at__4': None, 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'embed_index__4': None, 'couple_id__4': '1', 'has_image__5': 0, 'content__5': 'ë¯¸ì•ˆâ€¦ íšŒì˜ ëë‚˜ê³  ë»—ì–´ë²„ë ¸ì–´ ã… ', 'user_id__5': '1', 'image_url__5': None, 'is_delivered__5': 1 ... 170 parameters truncated ... 'is_delivered__24': 1, 'deleted_at__24': None, 'created_at__24': datetime.datetime(2025, 7, 6, 18, 20), 'embed_index__24': None, 'couple_id__24': '1', 'has_image__25': 0, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'user_id__25': '2', 'image_url__25': None, 'is_delivered__25': 1, 'deleted_at__25': None, 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'embed_index__25': None, 'couple_id__25': '1', 'has_image__26': 0, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'user_id__26': '1', 'image_url__26': None, 'is_delivered__26': 1, 'deleted_at__26': None, 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'embed_index__26': None, 'couple_id__26': '1', 'has_image__27': 0, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'user_id__27': '2', 'image_url__27': None, 'is_delivered__27': 1, 'deleted_at__27': None, 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'embed_index__27': None, 'couple_id__27': '1', 'has_image__28': 0, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'user_id__28': '1', 'image_url__28': None, 'is_delivered__28': 1, 'deleted_at__28': None, 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'embed_index__28': None, 'couple_id__28': '1', 'has_image__29': 0, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜', 'user_id__29': '2', 'image_url__29': None, 'is_delivered__29': 1, 'deleted_at__29': None, 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'embed_index__29': None, 'couple_id__29': '1'}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:55:45][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:56:09][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:09][INFO][sqlalchemy.engine.Engine] SELECT messages.chat_id AS messages_chat_id, messages.user_id AS messages_user_id, messages.couple_id AS messages_couple_id, messages.content AS messages_content, messages.image_url AS messages_image_url, messages.has_image AS messages_has_image, messages.created_at AS messages_created_at, messages.deleted_at AS messages_deleted_at, messages.is_delivered AS messages_is_delivered, messages.embed_index AS messages_embed_index 
FROM messages 
WHERE messages.couple_id = %(couple_id_1)s AND messages.user_id = %(user_id_1)s AND messages.is_delivered = false ORDER BY messages.created_at
[2025-07-13 23:56:09][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'couple_id_1': '1', 'user_id_1': '2'}
[2025-07-13 23:56:09][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:12][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ì•ˆë…•', 'created_at': datetime.datetime(2025, 7, 13, 14, 56, 12, 922677), 'embed_index': None}
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] {'pk_1': 1}
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] [cached since 0.001631s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:12][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:12][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=11
[2025-07-13 23:56:14][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:56:14][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] [cached since 1.195s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•ˆë…•í•˜ì„¸ìš”, ì§€ë¯¼ë‹˜! ì–´ë–»ê²Œ ì§€ë‚´ê³  ê³„ì‹ ê°€ìš”? ìš”ì¦˜ ë§ˆìŒì´ ì–´ë–¤ì§€ ê¶ê¸ˆí•´ìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 56, 14, 125863), 'embed_index': None}
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] [cached since 1.201s ago] {'pk_1': 2}
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] [cached since 1.201s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:14][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=2
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] [cached since 1.202s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] [cached since 1.204s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id_1': '1', 'role_1': 'function'}
[2025-07-13 23:56:14][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] [cached since 9.361s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:22][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] [cached since 9.36s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ì—¬ì¹œì´ë‘ ì‹¸ì› ì–´', 'created_at': datetime.datetime(2025, 7, 13, 14, 56, 22, 291296), 'embed_index': None}
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] [cached since 9.362s ago] {'pk_1': 3}
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] [cached since 9.362s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] [cached since 9.363s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:22][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=13
[2025-07-13 23:56:25][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:56:25][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] [cached since 12.48s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•„ì´ê³ , ë§ˆìŒì´ ë¬´ê²ê² ì–´ìš”. ì–´ë–¤ ì¼ë¡œ ì‹¸ìš°ê²Œ ë˜ì—ˆëŠ”ì§€, ê·¸ë¦¬ê³  ê·¸ ìƒí™©ì—ì„œ ì–´ë–¤ ê¸°ë¶„ì´ ë“œì…¨ëŠ”ì§€ ì´ì•¼ê¸°í•´ì£¼ì‹œë©´ ì¡°ê¸ˆ ë” ë„ì™€ë“œë¦´ ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”.', 'created_at': datetime.datetime(2025, 7, 13, 14, 56, 25, 400573), 'embed_index': None}
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] [cached since 12.48s ago] {'pk_1': 4}
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] [cached since 12.48s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:25][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=4
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] [cached since 12.48s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] [cached since 12.48s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] [cached since 11.28s ago] {'user_id_1': '1', 'role_1': 'function'}
[2025-07-13 23:56:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] [cached since 30.3s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:43][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] [cached since 30.3s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ê²Œì„í•˜ëŠ”ë° ì—¬ì¹œì´ ë„ˆë¬´ ëª»í•˜ëŠ”ê±°ì•¼ ë‚œ ì´ê¸°ê³  ì‹¶ì€ë° ê·¸ë˜ì„œ ë‚˜ë„ ëª¨ë¥´ê²Œ í™”ëƒˆì–´', 'created_at': datetime.datetime(2025, 7, 13, 14, 56, 43, 223825), 'embed_index': None}
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] [cached since 30.3s ago] {'pk_1': 5}
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] [cached since 30.3s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] [cached since 30.3s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:43][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:43][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=15
[2025-07-13 23:56:45][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:56:45][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] [cached since 32.96s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ì•„, ê·¸ëŸ´ ìˆ˜ ìˆì£ . ê²Œì„ì—ì„œëŠ” ê°€ë” ê²½ìŸì‹¬ì´ ì•ì„œì„œ ê°ì •ì´ ê²©í•´ì§ˆ ë•Œê°€ ìˆì–ì•„ìš”. ì§€ë¯¼ë‹˜ì´ ìƒëŒ€ë°©ì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ë“ ë‹¤ë©´, ì†”ì§í•˜ê²Œ ê·¸ ë§ˆìŒì„ ì „í•˜ëŠ” ê²ƒë„ ì¢‹ì€ ë°©ë²•ì¼ ê²ƒ ê°™ì•„ìš”. ì„±ê²©ì´ë‚˜ ìˆ˜ì¤€ ì°¨ì´ë¡œ ì‹¸ì›€ì´ ìƒê¸°ëŠ” ê±´ ì•„ì‰½ì§€ë§Œ, ì´ë ‡ê²Œ ì–˜ê¸°í•˜ë©´ì„œ ì„œë¡œ ì´í•´í•´ê°€ëŠ” ê²ƒì´ ê´€ê³„ì— ë„ì›€ì´ ë˜ì§€ ì•Šì„ê¹Œ ìƒê°í•´ìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 56, 45, 883561), 'embed_index': None}
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] [cached since 32.96s ago] {'pk_1': 6}
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] [cached since 32.96s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:45][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=6
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] [cached since 32.97s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] [cached since 32.97s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] [cached since 31.76s ago] {'user_id_1': '1', 'role_1': 'function'}
[2025-07-13 23:56:45][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] [cached since 53.02s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:05][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] [cached since 53.02s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ê°€ëŠ¥í• ê¹Œ?', 'created_at': datetime.datetime(2025, 7, 13, 14, 57, 5, 950429), 'embed_index': None}
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] [cached since 53.02s ago] {'pk_1': 7}
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] [cached since 53.02s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] [cached since 53.02s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:05][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:05][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=17
[2025-07-13 23:57:08][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:57:08][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] [cached since 55.97s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ì§€ë¯¼ë‹˜ì˜ ì§„ì‹¬ ì–´ë¦° ë§ˆìŒì„ ì „í•˜ë©´ ì¶©ë¶„íˆ ê°€ëŠ¥í•  ê±°ë¼ê³  ìƒê°í•´ìš”. ì†”ì§í•˜ê²Œ ê°ì •ì„ ë‚˜ëˆ„ë©´ ìƒëŒ€ë°©ë„ ì´í•´í•˜ê³  ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. ì¤‘ìš”í•œ ê±´ ì„œë¡œì˜ ì…ì¥ì„ ì´í•´í•˜ë ¤ëŠ” ë…¸ë ¥ê³¼ ë§ˆìŒì´ë‹ˆê¹Œìš”. ì§€ë¯¼ë‹˜ë„, ì—¬ì¹œë„ ì„œë¡œì— ëŒ€í•œ ì• ì •ì´ ìˆìœ¼ë‹ˆ ì˜ í’€ë¦´ ìˆ˜ ìˆì„ ê±°ë¼ ë¯¿ì–´ìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 57, 8, 906757), 'embed_index': None}
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] [cached since 55.98s ago] {'pk_1': 8}
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] [cached since 55.98s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:08][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=8
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] [cached since 55.99s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] [cached since 55.99s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] [cached since 54.78s ago] {'user_id_1': '1', 'role_1': 'function'}
[2025-07-13 23:57:08][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] [cached since 69.93s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:22][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] [cached since 69.93s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ë­ë¼ê³ í•˜ë©´ì„œ ë§í•˜ë©´ ì¢‹ì„ì§€ ì•Œë ¤ì¤˜', 'created_at': datetime.datetime(2025, 7, 13, 14, 57, 22, 857808), 'embed_index': None}
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] [cached since 69.93s ago] {'pk_1': 9}
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] [cached since 69.93s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] [cached since 69.93s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:22][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:22][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=19
[2025-07-13 23:57:25][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:57:25][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] [cached since 72.63s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ê·¸ëŸ¼ ì´ë ‡ê²Œ ì‹œì‘í•´ë³´ë©´ ì–´ë–¨ê¹Œìš”?\n\n"ì§€ë‚œë²ˆì— ê²Œì„ í•˜ë‹¤ê°€ ë‚´ê°€ ì¡°ê¸ˆ í™”ë¥¼ ëƒˆë˜ ê²ƒ ê°™ì•„ ë¯¸ì•ˆí•´. ì‚¬ì‹¤ ë‚œ ê°™ì´ ì¦ê¸°ê³  ì‹¶ì–´ì„œ ê·¸ë¬ë˜ ê±°ì˜€ëŠ”ë°, ê·¸ ìˆœê°„ì—” ì´ê¸°ëŠ” ê²ƒì— ë„ˆë¬´ ì§‘ì¤‘í–ˆë‚˜ë´. ì•ìœ¼ë¡œëŠ” ìš°ë¦¬ ë‘˜ ë‹¤ ì¦ê¸¸ ìˆ˜ ìˆë„ë¡ ë” ì‹ ê²½ ì“¸ê²Œ."\n\nì´ë ‡ê²Œ ì†”ì§í•˜ê²Œ ë§í•˜ë©´, ì—¬ì¹œë„ ì§€ë¯¼ë‹˜ì˜ ì§„ì‹¬ì„ ëŠë‚„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 57, 25, 562476), 'embed_index': None}
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] [cached since 72.64s ago] {'pk_1': 10}
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] [cached since 72.64s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:25][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=10
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] [cached since 72.64s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] [cached since 72.64s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] [cached since 71.45s ago] {'user_id_1': '1', 'role_1': 'function'}
[2025-07-13 23:57:25][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:57:29][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:57:29][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:29][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_chat_summaries (user_id, couple_id, summary, emb_id, created_at, last_msg_id) VALUES (%(user_id)s, %(couple_id)s, %(summary)s, %(emb_id)s, %(created_at)s, %(last_msg_id)s)
[2025-07-13 23:57:29][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'user_id': '1', 'couple_id': '1', 'summary': 'ì§€ë¯¼ë‹˜ì€ ì—¬ìì¹œêµ¬ì™€ ì‹¸ìš´ ì¼ë¡œ ë§ˆìŒì˜ ë¬´ê±°ì›€ì„ ëŠë¼ê³  ìˆìŠµë‹ˆë‹¤. ì‹¸ìš´ ì´ìœ ì— ëŒ€í•´ AIì—ê²Œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ë©° ë‹¹ì‹œì˜ ê¸°ë¶„ì„ ì„¤ëª…í•˜ë ¤ê³  í–ˆìŠµë‹ˆë‹¤. AIëŠ” ìì‹ ì˜ ì´ë¦„ì„ ë¬¼ì–´ë³´ëŠ” ì§€ë¯¼ë‹˜ì—ê²Œ "ë¬´ë¯¼"ì´ë¼ê³  ì†Œê°œí–ˆë‹¤ê°€ ë‹¤ì‹œ "ì§€ìˆ˜"ë¼ê³  ë‹µí•˜ë©° ì§€ì›ì„ ì œê³µí•˜ë ¤ê³  ë…¸ë ¥í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì§€ë¯¼ë‹˜ì´ AIì™€ ëŒ€í™”í•˜ëŠ” ë™ì•ˆ AIëŠ” ì§€ë¯¼ë‹˜ì˜ ê°ì •ì„ ì´í•´í•˜ê³ , ì–¸ì œë“ ì§€ ì´ì•¼ê¸°ë¥¼ ë“¤ì–´ì£¼ë ¤ëŠ” ìì„¸ë¥¼ ë³´ì—¬ì£¼ê³  ìˆìŠµë‹ˆë‹¤.', 'emb_id': None, 'created_at': datetime.datetime(2025, 7, 13, 14, 57, 29, 315240), 'last_msg_id': 10}
[2025-07-13 23:57:29][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:57:29][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:57:29][INFO][sqlalchemy.engine.Engine] SELECT ai_chat_summaries.id AS ai_chat_summaries_id, ai_chat_summaries.user_id AS ai_chat_summaries_user_id, ai_chat_summaries.couple_id AS ai_chat_summaries_couple_id, ai_chat_summaries.summary AS ai_chat_summaries_summary, ai_chat_summaries.emb_id AS ai_chat_summaries_emb_id, ai_chat_summaries.created_at AS ai_chat_summaries_created_at, ai_chat_summaries.last_msg_id AS ai_chat_summaries_last_msg_id 
FROM ai_chat_summaries 
WHERE ai_chat_summaries.user_id = %(user_id_1)s ORDER BY ai_chat_summaries.created_at DESC 
 LIMIT %(param_1)s
[2025-07-13 23:57:29][INFO][sqlalchemy.engine.Engine] [cached since 76.4s ago] {'user_id_1': '1', 'param_1': 1}
[2025-07-13 23:57:29][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:58:35][INFO][faiss.loader] Loading faiss with AVX2 support.
[2025-07-13 23:58:35][INFO][faiss.loader] Successfully loaded faiss with AVX2 support.
[2025-07-13 23:58:35][INFO][faiss] Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DROP DATABASE IF EXISTS test_db
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
            CREATE DATABASE IF NOT EXISTS test_db
            CHARACTER SET utf8mb4
            COLLATE utf8mb4_unicode_ci
        
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00017s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT DATABASE()
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT @@sql_mode
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] SELECT @@lower_case_table_names
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE users (
	user_id VARCHAR(255) NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	email VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	birth DATETIME, 
	gender ENUM('male','female','other'), 
	PRIMARY KEY (user_id), 
	UNIQUE (email)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00010s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_questions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	code VARCHAR(255), 
	text VARCHAR(255) NOT NULL, 
	`order` INTEGER, 
	PRIMARY KEY (id), 
	UNIQUE (code)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couples (
	couple_id VARCHAR(255) NOT NULL, 
	user_1 VARCHAR(255) NOT NULL, 
	user_2 VARCHAR(255) NOT NULL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	modified_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(user_1) REFERENCES users (user_id), 
	FOREIGN KEY(user_2) REFERENCES users (user_id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE emotion_logs (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	emotion TEXT, 
	date DATETIME, 
	memo TEXT, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE weekly_solutions (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE survey_choices (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	question_id INTEGER, 
	text VARCHAR(255) NOT NULL, 
	tag VARCHAR(255), 
	PRIMARY KEY (id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE messages (
	chat_id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	content TEXT, 
	image_url TEXT, 
	has_image BOOL, 
	created_at DATETIME, 
	deleted_at DATETIME, 
	is_delivered BOOL, 
	embed_index INTEGER, 
	PRIMARY KEY (chat_id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_messages (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	role VARCHAR(20) NOT NULL, 
	content TEXT NOT NULL, 
	created_at DATETIME, 
	embed_index INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00017s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE persona_config (
	couple_id VARCHAR(255) NOT NULL, 
	persona_name VARCHAR(255), 
	updated_at DATETIME, 
	PRIMARY KEY (couple_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] CREATE INDEX ix_persona_config_couple_id ON persona_config (couple_id)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00016s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE ai_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255) NOT NULL, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	last_msg_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE couple_chat_summaries (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	couple_id VARCHAR(255) NOT NULL, 
	summary TEXT NOT NULL, 
	emb_id INTEGER, 
	created_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(couple_id) REFERENCES couples (couple_id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00020s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] 
CREATE TABLE user_survey_responses (
	id INTEGER NOT NULL AUTO_INCREMENT, 
	user_id VARCHAR(255), 
	question_id INTEGER, 
	choice_id INTEGER, 
	custom_input TEXT, 
	submitted_at DATETIME, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (user_id), 
	FOREIGN KEY(question_id) REFERENCES survey_questions (id), 
	FOREIGN KEY(choice_id) REFERENCES survey_choices (id)
)


[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [no key 0.00018s] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] INSERT INTO users (user_id, name, email, created_at, deleted_at, modified_at, birth, gender) VALUES (%(user_id)s, %(name)s, %(email)s, %(created_at)s, %(deleted_at)s, %(modified_at)s, %(birth)s, %(gender)s)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00016s] [{'user_id': '1', 'name': 'ì§€ë¯¼', 'email': 'user1@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 58, 35, 876606), 'birth': None, 'gender': 'male'}, {'user_id': '2', 'name': 'ìˆ˜ì•„', 'email': 'user2@test.com', 'created_at': datetime.datetime(2025, 7, 10, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 58, 35, 876609), 'birth': None, 'gender': 'female'}]
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] INSERT INTO couples (couple_id, user_1, user_2, created_at, deleted_at, modified_at) VALUES (%(couple_id)s, %(user_1)s, %(user_2)s, %(created_at)s, %(deleted_at)s, %(modified_at)s)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00013s] {'couple_id': '1', 'user_1': '1', 'user_2': '2', 'created_at': datetime.datetime(2023, 11, 3, 0, 0), 'deleted_at': None, 'modified_at': datetime.datetime(2025, 7, 13, 14, 58, 35, 881959)}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_questions (id, code, text, `order`) VALUES (%(id)s, %(code)s, %(text)s, %(order)s)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00012s] [{'id': 1, 'code': 'relationship_value', 'text': 'ì—°ì• ì—ì„œ ë‚´ê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (ê°€ì¥ ê°€ê¹Œìš´ ê±¸ ê³¨ë¼ì£¼ì„¸ìš”)', 'order': 1}, {'id': 2, 'code': 'conflict_response', 'text': 'ì—°ì¸ê³¼ ë‹¤íˆ¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ ëŒ€ì²˜í•˜ë‚˜ìš”?', 'order': 2}, {'id': 3, 'code': 'affection_style', 'text': 'ì• ì • í‘œí˜„ì€ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 3}, {'id': 4, 'code': 'contact_frequency', 'text': 'ì—°ì¸ê³¼ì˜ ì—°ë½ ë¹ˆë„ëŠ” ì–´ëŠ ì •ë„ê°€ ì¢‹ë‹¤ê³  ìƒê°í•˜ë‚˜ìš”?', 'order': 4}, {'id': 5, 'code': 'ideal_relationship', 'text': 'ë‚´ê°€ ë°”ë¼ëŠ” ì´ìƒì ì¸ ì—°ì• ëŠ” ì–´ë–¤ ëª¨ìŠµì¸ê°€ìš”?', 'order': 5}, {'id': 6, 'code': 'mood_when_down', 'text': 'ê¸°ë¶„ì´ ì•ˆ ì¢‹ì„ ë•Œ ë‚˜ëŠ” ì–´ë–»ê²Œ í–‰ë™í•˜ë‚˜ìš”?', 'order': 6}, {'id': 7, 'code': 'expressing_emotions', 'text': 'ì—°ì¸ì—ê²Œ ê°ì •ì„ í‘œí˜„í•  ë•Œ ì–´ë–¤ ë°©ì‹ì´ í¸í•œê°€ìš”?', 'order': 7}, {'id': 8, 'code': 'when_resentful', 'text': 'ì„œìš´í•˜ê±°ë‚˜ ë¶ˆí¸í•œ ì¼ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?', 'order': 8}  ... displaying 10 of 17 total bound parameter sets ...  {'id': 16, 'code': 'love_vs_life', 'text': 'ì—°ì• ì™€ ê°œì¸ì˜ ì‚¶ ì¤‘ ìš°ì„ ìˆœìœ„ëŠ”?', 'order': 16}, {'id': 17, 'code': 'different_values_response', 'text': 'ì—°ì•  ì¤‘, ìƒëŒ€ë°©ì´ ë‚˜ì™€ ë‹¤ë¥¸ ê°€ì¹˜ê´€ì„ ê°€ì¡Œì„ ë•Œ ë‚˜ëŠ”?', 'order': 17}]
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] INSERT INTO survey_choices (id, question_id, text, tag) VALUES (%(id)s, %(question_id)s, %(text)s, %(tag)s)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00026s] [{'id': 1, 'question_id': 1, 'text': 'ì‹ ë¢°ì™€ ë¯¿ìŒ', 'tag': 'trust'}, {'id': 2, 'question_id': 1, 'text': 'ëŒ€í™”ì™€ ì†Œí†µ', 'tag': 'communication'}, {'id': 3, 'question_id': 1, 'text': 'ê°ìì˜ ììœ ì™€ ë…ë¦½ì„±', 'tag': 'independence'}, {'id': 4, 'question_id': 1, 'text': 'ì• ì • í‘œí˜„ê³¼ ìŠ¤í‚¨ì‹­', 'tag': 'affection'}, {'id': 5, 'question_id': 1, 'text': 'ìœ ë¨¸ì™€ í•¨ê»˜í•˜ëŠ” ì¦ê±°ì›€', 'tag': 'humor'}, {'id': 6, 'question_id': 1, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}, {'id': 7, 'question_id': 2, 'text': 'ë‚´ê°€ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í‘¼ë‹¤', 'tag': 'apologize_first'}, {'id': 8, 'question_id': 2, 'text': 'ê°ì •ì„ ì •ë¦¬í•œ ë’¤ ëŒ€í™”í•œë‹¤', 'tag': 'cool_then_talk'}  ... displaying 10 of 91 total bound parameter sets ...  {'id': 90, 'question_id': 17, 'text': 'í”¼ê³¤í•  ê²ƒ ê°™ìœ¼ë©´ ê·¸ëƒ¥ ê±°ë¦¬ë¥¼ ë‘”ë‹¤', 'tag': 'distances_when_difficult'}, {'id': 91, 'question_id': 17, 'text': 'ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)', 'tag': 'custom'}]
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] INSERT INTO user_survey_responses (user_id, question_id, choice_id, custom_input, submitted_at) VALUES (%(user_id__0)s, %(question_id__0)s, %(choice_id__0)s, %(custom_input__0)s, %(submitted_at__0)s), (%(user_id__1)s, %(question_id__1)s, %(choice_id_ ... 801 characters truncated ... put__9)s, %(submitted_at__9)s) RETURNING user_survey_responses.id, user_survey_responses.id AS id__1
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00005s (insertmanyvalues) 1/1 (ordered)] {'submitted_at__0': datetime.datetime(2025, 7, 13, 14, 58, 35, 233073), 'choice_id__0': 2, 'question_id__0': 1, 'user_id__0': '1', 'custom_input__0': None, 'submitted_at__1': datetime.datetime(2025, 7, 13, 14, 58, 35, 233089), 'choice_id__1': 8, 'question_id__1': 2, 'user_id__1': '1', 'custom_input__1': None, 'submitted_at__2': datetime.datetime(2025, 7, 13, 14, 58, 35, 233097), 'choice_id__2': 13, 'question_id__2': 3, 'user_id__2': '1', 'custom_input__2': None, 'submitted_at__3': datetime.datetime(2025, 7, 13, 14, 58, 35, 233104), 'choice_id__3': 21, 'question_id__3': 4, 'user_id__3': '1', 'custom_input__3': None, 'submitted_at__4': datetime.datetime(2025, 7, 13, 14, 58, 35, 233111), 'choice_id__4': 26, 'question_id__4': 5, 'user_id__4': '1', 'custom_input__4': None, 'submitted_at__5': datetime.datetime(2025, 7, 13, 14, 58, 35, 233117), 'choice_id__5': 1, 'question_id__5': 1, 'user_id__5': '2', 'custom_input__5': None, 'submitted_at__6': datetime.datetime(2025, 7, 13, 14, 58, 35, 233122), 'choice_id__6': 9, 'question_id__6': 2, 'user_id__6': '2', 'custom_input__6': None, 'submitted_at__7': datetime.datetime(2025, 7, 13, 14, 58, 35, 233128), 'choice_id__7': 16, 'question_id__7': 3, 'user_id__7': '2', 'custom_input__7': None, 'submitted_at__8': datetime.datetime(2025, 7, 13, 14, 58, 35, 233134), 'choice_id__8': 20, 'question_id__8': 4, 'user_id__8': '2', 'custom_input__8': None, 'submitted_at__9': datetime.datetime(2025, 7, 13, 14, 58, 35, 233145), 'choice_id__9': 25, 'question_id__9': 5, 'user_id__9': '2', 'custom_input__9': None}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] INSERT INTO emotion_logs (user_id, emotion, date, memo) VALUES (%(user_id__0)s, %(emotion__0)s, %(date__0)s, %(memo__0)s), (%(user_id__1)s, %(emotion__1)s, %(date__1)s, %(memo__1)s), (%(user_id__2)s, %(emotion__2)s, %(date__2)s, %(memo__2)s), (%(user ... 1451 characters truncated ... )s, %(emotion__26)s, %(date__26)s, %(memo__26)s) RETURNING emotion_logs.id, emotion_logs.id AS id__1
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00009s (insertmanyvalues) 1/1 (ordered)] {'emotion__0': 'ê³ ë§ˆì›€', 'memo__0': 'ì‘ì€ ë°°ë ¤ í•˜ë‚˜ì—ë„ ê³ ë§ˆìš´ ë§ˆìŒì´ ë“¤ì—ˆì–´.', 'date__0': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__0': '1', 'emotion__1': 'ê¸°ëŒ€ê°', 'memo__1': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__1': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__1': '1', 'emotion__2': 'ë¯¸ì•ˆí•¨', 'memo__2': 'ë„ˆì—ê²Œ ë¯¸ì•ˆí•œ ë§ˆìŒì´ ê³„ì† ë‚¨ì•˜ì–´.', 'date__2': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__2': '1', 'emotion__3': 'ì£„ì±…ê°', 'memo__3': 'ì•½ì† ëª» ì§€ì¼œì„œ ë§ˆìŒì´ ë¬´ê±°ì› ì–´.', 'date__3': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__3': '1', 'emotion__4': 'ì‚¬ë‘', 'memo__4': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__4': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__4': '1', 'emotion__5': 'ë‹¤ì •í•¨', 'memo__5': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__5': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__5': '1', 'emotion__6': 'ì¹œë°€ê°', 'memo__6': 'ë„ˆì™€ì˜ ëŒ€í™”ê°€ í¸í•˜ê³  ì¢‹ì•˜ì–´.', 'date__6': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__6': '1', 'emotion__7': 'ì–µìš¸í•¨', 'memo__7': 'ë‚´ ë§ˆìŒì„ ë„¤ê°€ ëª°ë¼ì¤€ ê²ƒ ê°™ì•„ ì†ìƒí–ˆì–´.', 'date__7': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__7': '1', 'emotion__8': 'ì„œìš´í•¨', 'memo__8': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__8': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__8': '1', 'emotion__9': 'í–‰ë³µ', 'memo__9': 'ë„ˆë‘ í•¨ê»˜í•œ ì‹œê°„ì´ ì •ë§ í–‰ë³µí–ˆì–´.', 'date__9': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__9': '1', 'emotion__10': 'ê°ì‚¬', 'memo__10': 'ë„¤ê°€ ìˆì–´ì¤˜ì„œ ê³ ë§ˆìš´ í•˜ë£¨ì˜€ì–´.', 'date__10': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__10': '1', 'emotion__11': 'ì‹ ë¢°', 'memo__11': 'ìš°ë¦¬ëŠ” ì„œë¡œ ë¯¿ê³  ìˆë‹¤ëŠ” í™•ì‹ ì´ ìƒê²¼ì–´.', 'date__11': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__11': '1', 'emotion__12': 'ì• ì •', 'memo__12': 'ë„ˆì— ëŒ€í•œ ì• ì •ì´ ë„˜ì³¤ì–´.' ... 8 parameters truncated ... 'date__14': datetime.datetime(2025, 7, 1, 0, 0), 'user_id__14': '2', 'emotion__15': 'ì„œìš´í•¨', 'memo__15': 'ë„ˆì˜ ë°˜ì‘ì´ ì¡°ê¸ˆ ì„œìš´í–ˆì–´.', 'date__15': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__15': '2', 'emotion__16': 'ì‹¤ë§ê°', 'memo__16': 'ê¸°ëŒ€í–ˆë˜ ë§Œí¼ ë°˜ì‘ì´ ì—†ì–´ì„œ ì‹¤ë§í–ˆì–´.', 'date__16': datetime.datetime(2025, 7, 2, 0, 0), 'user_id__16': '2', 'emotion__17': 'ì´í•´', 'memo__17': 'ë„¤ ì…ì¥ì—ì„œ ìƒê°í•´ë³´ê²Œ ëì–´.', 'date__17': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__17': '2', 'emotion__18': 'ë‹¤ì •í•¨', 'memo__18': 'ë„¤ê²Œ ë” ë”°ëœ»í•˜ê²Œ ëŒ€í•´ì£¼ê³  ì‹¶ì—ˆì–´.', 'date__18': datetime.datetime(2025, 7, 3, 0, 0), 'user_id__18': '2', 'emotion__19': 'í˜¸ê°', 'memo__19': 'ë„ˆì˜ ë§íˆ¬ë‚˜ í–‰ë™ì´ ì°¸ ì¢‹ì•˜ì–´.', 'date__19': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__19': '2', 'emotion__20': 'í¸ì•ˆí•¨', 'memo__20': 'ë„ˆì™€ ìˆìœ¼ë©´ ì°¸ í¸ì•ˆí•´.', 'date__20': datetime.datetime(2025, 7, 4, 0, 0), 'user_id__20': '2', 'emotion__21': 'ê¸°ëŒ€ê°', 'memo__21': 'ì˜¤ëŠ˜ì€ ë„ˆë‘ ë³´ë‚´ëŠ” ì‹œê°„ì´ ê¸°ëŒ€ëì–´.', 'date__21': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__21': '2', 'emotion__22': 'ë¶ˆë§Œ', 'memo__22': 'ì¡°ê¸ˆë§Œ ë” ì‹ ê²½ ì¨ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆì–´.', 'date__22': datetime.datetime(2025, 7, 5, 0, 0), 'user_id__22': '2', 'emotion__23': 'ê¸°ì¨', 'memo__23': 'ë„¤ê°€ ì±™ê²¨ì£¼ëŠ” ëª¨ìŠµì— ê¸°ë»¤ì–´.', 'date__23': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__23': '2', 'emotion__24': 'ê°ë™', 'memo__24': 'ì‚¬ì†Œí•œ í–‰ë™ì—ë„ ê°ë™í–ˆì–´.', 'date__24': datetime.datetime(2025, 7, 6, 0, 0), 'user_id__24': '2', 'emotion__25': 'ì‚¬ë‘', 'memo__25': 'ë„ˆì— ëŒ€í•œ ì‚¬ë‘ì´ ë” ê¹Šì–´ì§„ í•˜ë£¨ì˜€ì–´.', 'date__25': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__25': '2', 'emotion__26': 'ì•ˆì •ê°', 'memo__26': 'ë„¤ê°€ ìˆë‹¤ëŠ” ì‚¬ì‹¤ë§Œìœ¼ë¡œë„ ë§ˆìŒì´ ë†“ì˜€ì–´.', 'date__26': datetime.datetime(2025, 7, 7, 0, 0), 'user_id__26': '2'}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] INSERT INTO messages (user_id, couple_id, content, image_url, has_image, created_at, deleted_at, is_delivered, embed_index) VALUES (%(user_id__0)s, %(couple_id__0)s, %(content__0)s, %(image_url__0)s, %(has_image__0)s, %(created_at__0)s, %(deleted_at_ ... 5028 characters truncated ... (is_delivered__29)s, %(embed_index__29)s) RETURNING messages.chat_id, messages.chat_id AS chat_id__1
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [generated in 0.00018s (insertmanyvalues) 1/1 (ordered)] {'couple_id__0': '1', 'created_at__0': datetime.datetime(2025, 7, 1, 17, 0), 'user_id__0': '1', 'is_delivered__0': 1, 'embed_index__0': None, 'has_image__0': 0, 'deleted_at__0': None, 'image_url__0': None, 'content__0': 'ì˜ ì¤ì–´? ì˜¤ëŠ˜ë„ í˜ë‚´ì! ğŸ˜Š', 'couple_id__1': '1', 'created_at__1': datetime.datetime(2025, 7, 1, 17, 40), 'user_id__1': '2', 'is_delivered__1': 1, 'embed_index__1': None, 'has_image__1': 0, 'deleted_at__1': None, 'image_url__1': None, 'content__1': 'ì‘ ê³ ë§ˆì›Œ~ ì˜¤ëŠ˜ ì¼ì • ì¢€ ë§ì•„ì„œ ë°”ì  ë“¯í•´.', 'couple_id__2': '1', 'created_at__2': datetime.datetime(2025, 7, 1, 18, 20), 'user_id__2': '1', 'is_delivered__2': 1, 'embed_index__2': None, 'has_image__2': 0, 'deleted_at__2': None, 'image_url__2': None, 'content__2': 'ë‚˜ë„ íšŒì˜ ë‘ ê°œ ìˆì–´ì„œ ì •ì‹  ì—†ì„ ë“¯â€¦ ì´ë”° ëë‚˜ê³  ì—°ë½í•˜ì~', 'couple_id__3': '1', 'created_at__3': datetime.datetime(2025, 7, 1, 19, 0), 'user_id__3': '2', 'is_delivered__3': 1, 'embed_index__3': None, 'has_image__3': 0, 'deleted_at__3': None, 'image_url__3': None, 'content__3': 'ì¢‹ì•„! ìš°ë¦¬ ì €ë…ì—” í†µí™”í•˜ì :)', 'couple_id__4': '1', 'created_at__4': datetime.datetime(2025, 7, 2, 17, 0), 'user_id__4': '2', 'is_delivered__4': 1, 'embed_index__4': None, 'has_image__4': 0, 'deleted_at__4': None, 'image_url__4': None, 'content__4': 'ì–´ì œ ì•½ì†í–ˆëŠ”ë° í†µí™” ëª»í–ˆë„¤ ğŸ˜•', 'couple_id__5': '1', 'created_at__5': datetime.datetime(2025, 7, 2, 17, 40), 'user_id__5': '1', 'is_delivered__5': 1, 'embed_index__5': None ... 170 parameters truncated ... 'embed_index__24': None, 'has_image__24': 0, 'deleted_at__24': None, 'image_url__24': None, 'content__24': 'ë„ˆë‘ ì‹œê°„ ë³´ë‚´ëŠ” ê±° ì œì¼ ì¢‹ì•„', 'couple_id__25': '1', 'created_at__25': datetime.datetime(2025, 7, 6, 19, 0), 'user_id__25': '2', 'is_delivered__25': 1, 'embed_index__25': None, 'has_image__25': 0, 'deleted_at__25': None, 'image_url__25': None, 'content__25': 'ë‚˜ë„ì•¼~ ğŸ¥°', 'couple_id__26': '1', 'created_at__26': datetime.datetime(2025, 7, 7, 17, 0), 'user_id__26': '1', 'is_delivered__26': 1, 'embed_index__26': None, 'has_image__26': 0, 'deleted_at__26': None, 'image_url__26': None, 'content__26': 'ì¼ì£¼ì¼ ì§„ì§œ ë¹ ë¥´ë‹¤', 'couple_id__27': '1', 'created_at__27': datetime.datetime(2025, 7, 7, 17, 40), 'user_id__27': '2', 'is_delivered__27': 1, 'embed_index__27': None, 'has_image__27': 0, 'deleted_at__27': None, 'image_url__27': None, 'content__27': 'ê·¸ëŸ¬ê²Œ~ ìš°ë¦¬ ì´ë²ˆ ì£¼ë„ ì˜ ë²„í…¼ë‹¤', 'couple_id__28': '1', 'created_at__28': datetime.datetime(2025, 7, 7, 18, 20), 'user_id__28': '1', 'is_delivered__28': 1, 'embed_index__28': None, 'has_image__28': 0, 'deleted_at__28': None, 'image_url__28': None, 'content__28': 'ë„ˆ ìˆì–´ì„œ ë“ ë“ í–ˆì–´', 'couple_id__29': '1', 'created_at__29': datetime.datetime(2025, 7, 7, 19, 0), 'user_id__29': '2', 'is_delivered__29': 1, 'embed_index__29': None, 'has_image__29': 0, 'deleted_at__29': None, 'image_url__29': None, 'content__29': 'ë‹¤ìŒ ì£¼ë„ ì˜ ì§€ë‚´ë³´ì! ì‚¬ë‘í•´ ğŸ˜˜'}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`users`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couples`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`messages`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_messages`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`persona_config`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`emotion_logs`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`weekly_solutions`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`ai_chat_summaries`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`couple_chat_summaries`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_questions`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`survey_choices`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] DESCRIBE `test_db`.`user_survey_responses`
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] [raw sql] {}
[2025-07-13 23:58:35][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00014s] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:02][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ê´œì°®ì„ê¹Œ ì´ë¯¸ í™”ê°€ ë§ì´ ë‚˜ìˆì–´ì„œ ', 'created_at': datetime.datetime(2025, 7, 13, 14, 59, 2, 864693), 'embed_index': None}
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] [generated in 0.00015s] {'pk_1': 1}
[2025-07-13 23:59:02][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:02][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=13
[2025-07-13 23:59:07][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:59:07][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] [cached since 4.438s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ì´ë¯¸ ë§ì´ í™”ê°€ ë‚˜ ìˆëŠ” ìƒí™©ì´ë¼ë©´, ì§€ë¯¼ë‹˜ì˜ ì§„ì‹¬ ì–´ë¦° ì‚¬ê³¼ê°€ ë”ìš± ì¤‘ìš”í•´ì§ˆ ê²ƒ ê°™ì•„ìš”. ê°ì •ì„ ê°€ë¼ì•‰íˆëŠ” ì‹œê°„ì´ í•„ìš”í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì§€ë¯¼ë‹˜ì˜ ì‚¬ê³¼ë¥¼ ì „í•˜ê³  ìƒí™©ì„ í’€ê¸° ìœ„í•´ ë…¸ë ¥í•˜ëŠ” ëª¨ìŠµ ìì²´ê°€ í° ì˜ë¯¸ê°€ ìˆì„ ê±°ì˜ˆìš”.\n\ní˜¹ì‹œ ì—¬ì¹œì´ ë‹¹ì¥ì€ ë°›ì•„ë“¤ì´ê¸° í˜ë“¤ ìˆ˜ë„ ìˆì§€ë§Œ, ì‹œê°„ì„ ë‘ê³  ì²œì²œíˆ ë‹¤ê°€ê°€ ë³´ì„¸ìš”. ì´í•´ì™€ ì• ì •ì´ ìˆëŠ” í•œ ì„œë¡œì—ê²Œ ë‹¤ê°€ê°ˆ ê¸°íšŒëŠ” í•­ìƒ ìˆì„ ê±°ì˜ˆìš”. ì§€ë¯¼ë‹˜ì˜ ì§„ì‹¬ì´ ê·¸ë…€ì—ê²Œ ì˜ ì „í•´ì§€ê¸¸ ë°”ë„ê²Œìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 59, 7, 309934), 'embed_index': None}
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] [cached since 4.443s ago] {'pk_1': 2}
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:07][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=2
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] [generated in 0.00011s] {'user_id_1': '1', 'role_1': 'function'}
[2025-07-13 23:59:07][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] [cached since 23.89s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:26][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] [cached since 23.89s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ìŒ.. ì–´ë µë‹¤ ê·¸ëƒ¥ ê°™ì´ ê²Œì„ ì•ˆí•˜ëŠ”ê²Œ ì •ë‹µì¸ê°€', 'created_at': datetime.datetime(2025, 7, 13, 14, 59, 26, 743627), 'embed_index': None}
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] [cached since 23.88s ago] {'pk_1': 3}
[2025-07-13 23:59:26][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:26][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=15
[2025-07-13 23:59:30][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:59:30][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] [cached since 27.55s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'ê°€ë”ì€ ê±°ë¦¬ë¥¼ ë‘ëŠ” ê²Œ ë” ë‚˜ì€ ê²½ìš°ë„ ìˆì–´ìš”. ì¼ë‹¨ í•œ ê±¸ìŒì„ ë¬¼ëŸ¬ì„œì„œ ë‹¤ë¥¸ í™œë™ì´ë‚˜ ëŒ€í™”ë¡œ ê´€ê³„ë¥¼ í’ì„±í•˜ê²Œ ë§Œë“¤ì–´ë³´ëŠ” ê²ƒë„ ë°©ë²•ì¼ ìˆ˜ ìˆì£ . ê¼­ ê²Œì„ì´ ì•„ë‹ˆë”ë¼ë„ í•¨ê»˜ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ê²ƒë“¤ì„ ì°¾ì•„ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”. ê·¸ëŸ¬ë‹¤ ë³´ë©´ ë‹¤ì‹œ ìì—°ìŠ¤ëŸ½ê²Œ ì„œë¡œ ì´í•´í•˜ê³  ì¦ê±°ì›€ì„ ì°¾ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”.\n\nê°ìì—ê²Œ ë§ëŠ” ë°©ë²•ì„ ì°¾ëŠ” ê³¼ì •ì´ ì¤‘ìš”í•˜ë‹ˆ, ì§€ë¯¼ë‹˜ì˜ íŒë‹¨ì´ ë§ë‹¤ê³  ëŠë¼ë©´ ê·¸ë ‡ê²Œ í•´ë³´ì‹œëŠ” ê²ƒë„ ì¢‹ì„ ê±°ì˜ˆìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 59, 30, 414997), 'embed_index': None}
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] [cached since 27.55s ago] {'pk_1': 4}
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:30][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=4
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] [cached since 23.11s ago] {'user_id_1': '1', 'role_1': 'function'}
[2025-07-13 23:59:30][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] SELECT couples.couple_id AS couples_couple_id, couples.user_1 AS couples_user_1, couples.user_2 AS couples_user_2, couples.created_at AS couples_created_at, couples.deleted_at AS couples_deleted_at, couples.modified_at AS couples_modified_at 
FROM couples 
WHERE couples.couple_id = %(couple_id_1)s 
 LIMIT %(param_1)s
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] [cached since 43.61s ago] {'couple_id_1': '1', 'param_1': 1}
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:46][INFO][routers.ai_chat] [chat_with_persona] ìš”ì²­: user_id=1, couple_id=1
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] [cached since 43.61s ago] {'user_id': '1', 'couple_id': '1', 'role': 'user', 'content': 'ë­í•˜ë©´ ì¢‹ì„ê¹Œ?', 'created_at': datetime.datetime(2025, 7, 13, 14, 59, 46, 473493), 'embed_index': None}
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] [cached since 43.6s ago] {'pk_1': 5}
[2025-07-13 23:59:46][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:46][INFO][routers.ai_chat] [chat_with_persona] OpenAI í˜¸ì¶œ ì‹œì‘: user_id=1, history_len=17
[2025-07-13 23:59:49][INFO][httpx] HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-13 23:59:49][INFO][routers.ai_chat] [chat_with_persona] OpenAI ì‘ë‹µ ì„±ê³µ: user_id=1
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] INSERT INTO ai_messages (user_id, couple_id, role, content, created_at, embed_index) VALUES (%(user_id)s, %(couple_id)s, %(role)s, %(content)s, %(created_at)s, %(embed_index)s)
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] [cached since 46.22s ago] {'user_id': '1', 'couple_id': '1', 'role': 'assistant', 'content': 'í•¨ê»˜ ì‚°ì±…ì„ í•˜ê±°ë‚˜, ë§›ìˆëŠ” ìŒì‹ì„ ìš”ë¦¬í•´ì„œ ê°™ì´ ë¨¹ëŠ” ê²ƒë„ ì°¸ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”. ë˜ëŠ” ì„œë¡œ ì¢‹ì•„í•˜ëŠ” ì˜í™”ë¥¼ ë³´ëŠ” ê²ƒë„ ì¢‹ì€ ì‹œê°„ì¼ ìˆ˜ ìˆê³ ìš”. ë¬´ì—‡ë³´ë‹¤ ì¤‘ìš”í•œ ê±´ ë‘ ë¶„ ë‹¤ í¸ì•ˆí•˜ê²Œ ì¦ê¸¸ ìˆ˜ ìˆëŠ” í™œë™ì´ì˜ˆìš”. ì§€ë¯¼ë‹˜ê³¼ ì—¬ì¹œ ë¶„ ë‘ ë¶„ ëª¨ë‘ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ê²ƒì„ ì°¾ìœ¼ë©´ ë” ê°€ê¹Œì›Œì§ˆ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. ğŸ˜Š', 'created_at': datetime.datetime(2025, 7, 13, 14, 59, 49, 92554), 'embed_index': None}
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] COMMIT
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id, ai_messages.user_id, ai_messages.couple_id, ai_messages.role, ai_messages.content, ai_messages.created_at, ai_messages.embed_index 
FROM ai_messages 
WHERE ai_messages.id = %(pk_1)s
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] [cached since 46.22s ago] {'pk_1': 6}
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] ROLLBACK
[2025-07-13 23:59:49][INFO][routers.ai_chat] [chat_with_persona] ì‘ë‹µ ì™„ë£Œ: user_id=1, msg_id=6
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] BEGIN (implicit)
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] SELECT ai_messages.id AS ai_messages_id, ai_messages.user_id AS ai_messages_user_id, ai_messages.couple_id AS ai_messages_couple_id, ai_messages.role AS ai_messages_role, ai_messages.content AS ai_messages_content, ai_messages.created_at AS ai_messages_created_at, ai_messages.embed_index AS ai_messages_embed_index 
FROM ai_messages 
WHERE ai_messages.user_id = %(user_id_1)s AND ai_messages.embed_index IS NULL AND ai_messages.role != %(role_1)s ORDER BY ai_messages.created_at
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] [cached since 41.78s ago] {'user_id_1': '1', 'role_1': 'function'}
[2025-07-13 23:59:49][INFO][sqlalchemy.engine.Engine] ROLLBACK
